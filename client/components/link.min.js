/**
 * @license
 * Link.JS Game Engine - v0.0.1
 * Copyright (c) 2013, Vsevolod Strukchinsky
 * hhttps://github.com/floatdrop/link.js
 *
 * Compiled: 2013-05-24
 *
 * Link.JS Game Engine is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
var Stats=function(){var t=Date.now(),e=t,i=0,r=1/0,n=0,o=0,s=1/0,a=0,h=0,c=0,u=document.createElement("div");u.id="stats",u.addEventListener("mousedown",function(t){t.preventDefault(),b(++c%2)},!1),u.style.cssText="width:80px;opacity:0.9;cursor:pointer";var l=document.createElement("div");l.id="fps",l.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",u.appendChild(l);var d=document.createElement("div");d.id="fpsText",d.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",d.innerHTML="FPS",l.appendChild(d);var p=document.createElement("div");for(p.id="fpsGraph",p.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",l.appendChild(p);74>p.children.length;){var f=document.createElement("span");f.style.cssText="width:1px;height:30px;float:left;background-color:#113",p.appendChild(f)}var I=document.createElement("div");I.id="ms",I.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",u.appendChild(I);var y=document.createElement("div");y.id="msText",y.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",y.innerHTML="MS",I.appendChild(y);var v=document.createElement("div");for(v.id="msGraph",v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",I.appendChild(v);74>v.children.length;){var g=document.createElement("span");g.style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(g)}var b=function(t){switch(c=t){case 0:l.style.display="block",I.style.display="none";break;case 1:l.style.display="none",I.style.display="block"}},m=function(t,e){var i=t.appendChild(t.firstChild);i.style.height=e+"px"};return{REVISION:11,domElement:u,setMode:b,begin:function(){t=Date.now()},end:function(){var c=Date.now();return i=c-t,r=Math.min(r,i),n=Math.max(n,i),y.textContent=i+" MS ("+r+"-"+n+")",m(v,Math.min(30,30-30*(i/200))),h++,c>e+1e3&&(o=Math.round(1e3*h/(c-e)),s=Math.min(s,o),a=Math.max(a,o),d.textContent=o+" FPS ("+s+"-"+a+")",m(p,Math.min(30,30-30*(o/100))),e=c,h=0),c},update:function(){t=this.end()}}};("function"==typeof define?function(t){define("msgpack-js",t)}:"object"==typeof exports?function(t){module.exports=t()}:function(t){this.msgpack=t()})(function(){"use strict";function t(t){if(void 0===t)return"undefined";var e,i;if(t instanceof ArrayBuffer?(i="ArrayBuffer",e=new DataView(t)):t instanceof DataView&&(i="DataView",e=t),!e)return JSON.stringify(t);for(var r=[],n=0;t.byteLength>n;n++){if(n>20){r.push("...");break}var o=e.getUint8(n).toString(16);1===o.length&&(o="0"+o),r.push(o)}return"<"+i+" "+r.join(" ")+">"}function e(t,e,i){t.byteLength;for(var r=0,n=i.length;n>r;r++){var o=i.charCodeAt(r);if(128>o)t.setUint8(e++,0|127&o>>>0);else if(2048>o)t.setUint8(e++,192|31&o>>>6),t.setUint8(e++,128|63&o>>>0);else if(65536>o)t.setUint8(e++,224|15&o>>>12),t.setUint8(e++,128|63&o>>>6),t.setUint8(e++,128|63&o>>>0);else{if(!(1114112>o))throw Error("bad codepoint "+o);t.setUint8(e++,240|7&o>>>18),t.setUint8(e++,128|63&o>>>12),t.setUint8(e++,128|63&o>>>6),t.setUint8(e++,128|63&o>>>0)}}}function i(t,e,i){for(var r="",n=e,o=e+i;o>n;n++){var s=t.getUint8(n);if(0!==(128&s))if(192!==(224&s))if(224!==(240&s)){if(240!==(248&s))throw Error("Invalid byte "+s.toString(16));r+=String.fromCharCode((7&s)<<18|(63&t.getUint8(++n))<<12|(63&t.getUint8(++n))<<6|(63&t.getUint8(++n))<<0)}else r+=String.fromCharCode((15&s)<<12|(63&t.getUint8(++n))<<6|(63&t.getUint8(++n))<<0);else r+=String.fromCharCode((15&s)<<6|63&t.getUint8(++n));else r+=String.fromCharCode(s)}return r}function r(t){for(var e=0,i=0,r=t.length;r>i;i++){var n=t.charCodeAt(i);if(128>n)e+=1;else if(2048>n)e+=2;else if(65536>n)e+=3;else{if(!(1114112>n))throw Error("bad codepoint "+n);e+=4}}return e}function n(t,e){this.offset=e||0,this.view=t}function o(t){var e=new DataView(t),i=new n(e),r=i.parse();if(i.offset!==t.byteLength)throw Error(t.byteLength-i.offset+" trailing bytes");return r}function s(t,i,n){var o=typeof t;if("string"===o){var a=r(t);if(32>a)return i.setUint8(n,160|a),e(i,n+1,t),1+a;if(65536>a)return i.setUint8(n,218),i.setUint16(n+1,a),e(i,n+3,t),3+a;if(4294967296>a)return i.setUint8(n,219),i.setUint32(n+1,a),e(i,n+5,t),5+a}if(t instanceof ArrayBuffer){var a=t.byteLength;if(65536>a)return i.setUint8(n,216),i.setUint16(n+1,a),new Uint8Array(i.buffer).set(new Uint8Array(t),n+3),3+a;if(4294967296>a)return i.setUint8(n,217),i.setUint32(n+1,a),new Uint8Array(i.buffer).set(new Uint8Array(t),n+5),5+a}if("number"===o){if(t<<0!==t)return i.setUint8(n,203),i.setFloat64(n+1,t),9;if(t>=0){if(128>t)return i.setUint8(n,t),1;if(256>t)return i.setUint8(n,204),i.setUint8(n+1,t),2;if(65536>t)return i.setUint8(n,205),i.setUint16(n+1,t),3;if(4294967296>t)return i.setUint8(n,206),i.setUint32(n+1,t),5;throw Error("Number too big 0x"+t.toString(16))}if(t>=-32)return i.setInt8(n,t),1;if(t>=-128)return i.setUint8(n,208),i.setInt8(n+1,t),2;if(t>=-32768)return i.setUint8(n,209),i.setInt16(n+1,t),3;if(t>=-2147483648)return i.setUint8(n,210),i.setInt32(n+1,t),5;throw Error("Number too small -0x"+(-t).toString(16).substr(1))}if("undefined"===o)return i.setUint8(n,196),1;if(null===t)return i.setUint8(n,192),1;if("boolean"===o)return i.setUint8(n,t?195:194),1;if("object"===o){var a,h=0,c=Array.isArray(t);if(c)a=t.length;else{var u=Object.keys(t);a=u.length}var h;if(16>a?(i.setUint8(n,a|(c?144:128)),h=1):65536>a?(i.setUint8(n,c?220:222),i.setUint16(n+1,a),h=3):4294967296>a&&(i.setUint8(n,c?221:223),i.setUint32(n+1,a),h=5),c)for(var l=0;a>l;l++)h+=s(t[l],i,n+h);else for(var l=0;a>l;l++){var d=u[l];h+=s(d,i,n+h),h+=s(t[d],i,n+h)}return h}throw Error("Unknown type "+o)}function a(t){var e=typeof t;if("string"===e){var i=r(t);if(32>i)return 1+i;if(65536>i)return 3+i;if(4294967296>i)return 5+i}if(t instanceof ArrayBuffer){var i=t.byteLength;if(65536>i)return 3+i;if(4294967296>i)return 5+i}if("number"===e){if(t<<0!==t)return 9;if(t>=0){if(128>t)return 1;if(256>t)return 2;if(65536>t)return 3;if(4294967296>t)return 5;if(0x10000000000000000>t)return 9;throw Error("Number too big 0x"+t.toString(16))}if(t>=-32)return 1;if(t>=-128)return 2;if(t>=-32768)return 3;if(t>=-2147483648)return 5;if(t>=-0x8000000000000000)return 9;throw Error("Number too small -0x"+t.toString(16).substr(1))}if("boolean"===e||"undefined"===e||null===t)return 1;if("object"===e){var i,n=0;if(Array.isArray(t)){i=t.length;for(var o=0;i>o;o++)n+=a(t[o])}else{var s=Object.keys(t);i=s.length;for(var o=0;i>o;o++){var h=s[o];n+=a(h)+a(t[h])}}if(16>i)return 1+n;if(65536>i)return 3+n;if(4294967296>i)return 5+n;throw Error("Array or object too long 0x"+i.toString(16))}throw Error("Unknown type "+e)}var h={};return h.inspect=t,h.utf8Write=e,h.utf8Read=i,h.utf8ByteCount=r,h.encode=function(t){var e=new ArrayBuffer(a(t)),i=new DataView(e);return s(t,i,0),e},h.decode=o,n.prototype.map=function(t){for(var e={},i=0;t>i;i++){var r=this.parse();e[r]=this.parse()}return e},n.prototype.buf=function(t){var e=new ArrayBuffer(t);return new Uint8Array(e).set(new Uint8Array(this.view.buffer,this.offset,t),0),this.offset+=t,e},n.prototype.raw=function(t){var e=i(this.view,this.offset,t);return this.offset+=t,e},n.prototype.array=function(t){for(var e=Array(t),i=0;t>i;i++)e[i]=this.parse();return e},n.prototype.parse=function(){var t,e,i=this.view.getUint8(this.offset);if(160===(224&i))return e=31&i,this.offset++,this.raw(e);if(128===(240&i))return e=15&i,this.offset++,this.map(e);if(144===(240&i))return e=15&i,this.offset++,this.array(e);if(0===(128&i))return this.offset++,i;if(224===(224&i))return t=this.view.getInt8(this.offset),this.offset++,t;switch(i){case 218:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.raw(e);case 219:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.raw(e);case 192:return this.offset++,null;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return this.offset++,void 0;case 204:return t=this.view.getUint8(this.offset+1),this.offset+=2,t;case 205:return t=this.view.getUint16(this.offset+1),this.offset+=3,t;case 206:return t=this.view.getUint32(this.offset+1),this.offset+=5,t;case 208:return t=this.view.getInt8(this.offset+1),this.offset+=2,t;case 209:return t=this.view.getInt16(this.offset+1),this.offset+=3,t;case 210:return t=this.view.getInt32(this.offset+1),this.offset+=5,t;case 222:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.map(e);case 223:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.map(e);case 220:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.array(e);case 221:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.array(e);case 216:return e=this.view.getUint16(this.offset+1),this.offset+=3,this.buf(e);case 217:return e=this.view.getUint32(this.offset+1),this.offset+=5,this.buf(e);case 202:return t=this.view.getFloat32(this.offset+1),this.offset+=5,t;case 203:return t=this.view.getFloat64(this.offset+1),this.offset+=9,t}throw Error("Unknown type 0x"+i.toString(16))},h}),function(t){"function"==typeof define?define(t):"function"==typeof YUI?YUI.add("es5",t):t()}(function(){function t(){}function e(t){return t=+t,t!==t?t=0:0!==t&&t!==1/0&&t!==-(1/0)&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t}function i(t){var e=typeof t;return null===t||"undefined"===e||"boolean"===e||"number"===e||"string"===e}Function.prototype.bind||(Function.prototype.bind=function(e){var i=this;if("function"!=typeof i)throw new TypeError("Function.prototype.bind called on incompatible "+i);var r=o.call(arguments,1),n=function(){if(this instanceof n){var t=i.apply(this,r.concat(o.call(arguments)));return Object(t)===t?t:this}return i.apply(e,r.concat(o.call(arguments)))};return i.prototype&&(t.prototype=i.prototype,n.prototype=new t,t.prototype=null),n});var r=Function.prototype.call,n=Object.prototype,o=Array.prototype.slice,s=r.bind(n.toString),a=r.bind(n.hasOwnProperty);if(a(n,"__defineGetter__")&&(r.bind(n.__defineGetter__),r.bind(n.__defineSetter__),r.bind(n.__lookupGetter__),r.bind(n.__lookupSetter__)),2!=[1,2].splice(0).length){var h=Array.prototype.splice;Array.prototype.splice=function(t,e){return arguments.length?h.apply(this,[void 0===t?0:t,void 0===e?this.length-t:e].concat(o.call(arguments,2))):[]}}if(1!=[].unshift(0)){var c=Array.prototype.unshift;Array.prototype.unshift=function(){return c.apply(this,arguments),this.length}}Array.isArray||(Array.isArray=function(t){return"[object Array]"==s(t)});var r=Object("a"),u="a"!=r[0]||!(0 in r);if(Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var i=w(this),r=u&&"[object String]"==s(this)?this.split(""):i,n=-1,o=r.length>>>0;if("[object Function]"!=s(t))throw new TypeError;for(;o>++n;)n in r&&t.call(e,r[n],n,i)}),Array.prototype.map||(Array.prototype.map=function(t,e){var i=w(this),r=u&&"[object String]"==s(this)?this.split(""):i,n=r.length>>>0,o=Array(n);if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");for(var a=0;n>a;a++)a in r&&(o[a]=t.call(e,r[a],a,i));return o}),Array.prototype.filter||(Array.prototype.filter=function(t,e){var i,r=w(this),n=u&&"[object String]"==s(this)?this.split(""):r,o=n.length>>>0,a=[];if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");for(var h=0;o>h;h++)h in n&&(i=n[h],t.call(e,i,h,r)&&a.push(i));return a}),Array.prototype.every||(Array.prototype.every=function(t,e){var i=w(this),r=u&&"[object String]"==s(this)?this.split(""):i,n=r.length>>>0;if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");for(var o=0;n>o;o++)if(o in r&&!t.call(e,r[o],o,i))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t,e){var i=w(this),r=u&&"[object String]"==s(this)?this.split(""):i,n=r.length>>>0;if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");for(var o=0;n>o;o++)if(o in r&&t.call(e,r[o],o,i))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e=w(this),i=u&&"[object String]"==s(this)?this.split(""):e,r=i.length>>>0;if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");if(!r&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var n,o=0;if(arguments.length>=2)n=arguments[1];else for(;;){if(o in i){n=i[o++];break}if(++o>=r)throw new TypeError("reduce of empty array with no initial value")}for(;r>o;o++)o in i&&(n=t.call(void 0,n,i[o],o,e));return n}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(t){var e=w(this),i=u&&"[object String]"==s(this)?this.split(""):e,r=i.length>>>0;if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");if(!r&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var n,r=r-1;if(arguments.length>=2)n=arguments[1];else for(;;){if(r in i){n=i[r--];break}if(0>--r)throw new TypeError("reduceRight of empty array with no initial value")}do r in this&&(n=t.call(void 0,n,i[r],r,e));while(r--);return n}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(t){var i=u&&"[object String]"==s(this)?this.split(""):w(this),r=i.length>>>0;if(!r)return-1;var n=0;for(arguments.length>1&&(n=e(arguments[1])),n=n>=0?n:Math.max(0,r+n);r>n;n++)if(n in i&&i[n]===t)return n;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(t){var i=u&&"[object String]"==s(this)?this.split(""):w(this),r=i.length>>>0;if(!r)return-1;var n=r-1;for(arguments.length>1&&(n=Math.min(n,e(arguments[1]))),n=n>=0?n:r-Math.abs(n);n>=0;n--)if(n in i&&t===i[n])return n;return-1}),!Object.keys){var l,d=!0,p="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),f=p.length;for(l in{toString:null})d=!1;Object.keys=function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.keys called on a non-object");var e,i=[];for(e in t)a(t,e)&&i.push(e);if(d)for(e=0;f>e;e++){var r=p[e];a(t,r)&&i.push(r)}return i}}Date.prototype.toISOString&&-1!==new Date(-621987552e5).toISOString().indexOf("-000001")||(Date.prototype.toISOString=function(){var t,e,i,r;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(r=this.getUTCFullYear(),t=this.getUTCMonth(),r+=Math.floor(t/12),t=[(t%12+12)%12+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],r=(0>r?"-":r>9999?"+":"")+("00000"+Math.abs(r)).slice(r>=0&&9999>=r?-4:-6),e=t.length;e--;)i=t[e],10>i&&(t[e]="0"+i);return r+"-"+t.slice(0,2).join("-")+"T"+t.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}),l=!1;try{l=Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(-621987552e5).toJSON().indexOf("-000001")&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(I){}l||(Date.prototype.toJSON=function(){var t,e=Object(this);t:{if(!i(e)){if(t=e.valueOf,"function"==typeof t&&(t=t.call(e),i(t)))break t;if(t=e.toString,"function"==typeof t&&(t=t.call(e),i(t)))break t;throw new TypeError}t=e}if("number"==typeof t&&!isFinite(t))return null;if(t=e.toISOString,"function"!=typeof t)throw new TypeError("toISOString property is not callable");return t.call(e)});var y,v=Date,g=function(t,e,i,r,n,o,s){var a=arguments.length;return this instanceof v?(a=1==a&&t+""===t?new v(g.parse(t)):a>=7?new v(t,e,i,r,n,o,s):a>=6?new v(t,e,i,r,n,o):a>=5?new v(t,e,i,r,n):a>=4?new v(t,e,i,r):a>=3?new v(t,e,i):a>=2?new v(t,e):a>=1?new v(t):new v,a.constructor=g,a):v.apply(this,arguments)},b=function(t,e){var i=e>1?1:0;return x[e]+Math.floor((t-1969+i)/4)-Math.floor((t-1901+i)/100)+Math.floor((t-1601+i)/400)+365*(t-1970)},m=RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),x=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(y in v)g[y]=v[y];if(g.now=v.now,g.UTC=v.UTC,g.prototype=v.prototype,g.prototype.constructor=g,g.parse=function(t){var e=m.exec(t);if(e){var i=Number(e[1]),r=Number(e[2]||1)-1,n=Number(e[3]||1)-1,o=Number(e[4]||0),s=Number(e[5]||0),a=Number(e[6]||0),h=Number(e[7]||0),c=!e[4]||e[8]?0:Number(new v(1970,0)),u="-"===e[9]?1:-1,l=Number(e[10]||0),e=Number(e[11]||0);return(s>0||a>0||h>0?24:25)>o&&60>s&&60>a&&1e3>h&&r>-1&&12>r&&24>l&&60>e&&n>-1&&b(i,r+1)-b(i,r)>n&&(i=60*(24*(b(i,r)+n)+o+l*u),i=1e3*(60*(i+s+e*u)+a)+h+c,i>=-864e13&&864e13>=i)?i:0/0}return v.parse.apply(this,arguments)},Date=g,Date.now||(Date.now=function(){return(new Date).getTime()}),"0".split(void 0,0).length){var P=String.prototype.split;String.prototype.split=function(t,e){return void 0===t&&0===e?[]:P.apply(this,arguments)}}if("".substr&&"b"!=="0b".substr(-1)){var T=String.prototype.substr;String.prototype.substr=function(t,e){return T.call(this,0>t?0>(t=this.length+t)?0:t:t,e)}}if(y="	\n\f\r   ᠎             　\u2028\u2029﻿",!String.prototype.trim||y.trim()){y="["+y+"]";var _=RegExp("^"+y+y+"*"),X=RegExp(y+y+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return(this+"").replace(_,"").replace(X,"")}}var w=function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return Object(t)}}),function(t){"function"==typeof define?define(t):"function"==typeof YUI?YUI.add("es5-sham",t):t()}(function(){function t(t){try{return Object.defineProperty(t,"sentinel",{}),"sentinel"in t}catch(e){}}var e,i,r,n,o,s=Function.prototype.call,a=Object.prototype,h=s.bind(a.hasOwnProperty);if((o=h(a,"__defineGetter__"))&&(e=s.bind(a.__defineGetter__),i=s.bind(a.__defineSetter__),r=s.bind(a.__lookupGetter__),n=s.bind(a.__lookupSetter__)),Object.getPrototypeOf||(Object.getPrototypeOf=function(t){return t.__proto__||(t.constructor?t.constructor.prototype:a)}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(t,e){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+t);if(h(t,e)){var i={enumerable:!0,configurable:!0};if(o){var s=t.__proto__;t.__proto__=a;var c=r(t,e),u=n(t,e);if(t.__proto__=s,c||u)return c&&(i.get=c),u&&(i.set=u),i}return i.value=t[e],i}}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),!Object.create){var c;if(null===Object.prototype.__proto__||"undefined"==typeof document)c=function(){return{__proto__:null}};else{var u=function(){},s=document.createElement("iframe"),l=document.body||document.documentElement;s.style.display="none",l.appendChild(s),s.src="javascript:";var d=s.contentWindow.Object.prototype;l.removeChild(s),s=null,delete d.constructor,delete d.hasOwnProperty,delete d.propertyIsEnumerable,delete d.isPrototypeOf,delete d.toLocaleString,delete d.toString,delete d.valueOf,d.__proto__=null,u.prototype=d,c=function(){return new u}}Object.create=function(t,e){function i(){}var r;if(null===t)r=c();else{if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object or null");i.prototype=t,r=new i,r.__proto__=t}return void 0!==e&&Object.defineProperties(r,e),r}}if(Object.defineProperty&&(s=t({}),l="undefined"==typeof document||t(document.createElement("div")),!s||!l))var p=Object.defineProperty,f=Object.defineProperties;(!Object.defineProperty||p)&&(Object.defineProperty=function(t,s,c){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.defineProperty called on non-object: "+t);if("object"!=typeof c&&"function"!=typeof c||null===c)throw new TypeError("Property description must be an object: "+c);if(p)try{return p.call(Object,t,s,c)}catch(u){}if(h(c,"value"))if(o&&(r(t,s)||n(t,s))){var l=t.__proto__;t.__proto__=a,delete t[s],t[s]=c.value,t.__proto__=l}else t[s]=c.value;else{if(!o)throw new TypeError("getters & setters can not be defined on this javascript engine");h(c,"get")&&e(t,s,c.get),h(c,"set")&&i(t,s,c.set)}return t}),(!Object.defineProperties||f)&&(Object.defineProperties=function(t,e){if(f)try{return f.call(Object,t,e)}catch(i){}for(var r in e)h(e,r)&&"__proto__"!=r&&Object.defineProperty(t,r,e[r]);return t}),Object.seal||(Object.seal=function(t){return t}),Object.freeze||(Object.freeze=function(t){return t});try{Object.freeze(function(){})}catch(I){var y=Object.freeze;Object.freeze=function(t){return"function"==typeof t?t:y(t)}}Object.preventExtensions||(Object.preventExtensions=function(t){return t}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)!==t)throw new TypeError;for(var e="";h(t,e);)e+="?";t[e]=!0;var i=h(t,e);return delete t[e],i})}),function(){function HEXtoRGB(t){return[(255&t>>16)/255,(255&t>>8)/255,(255&t)/255]}function determineMatrixArrayType(){return PIXI.Matrix="undefined"!=typeof Float32Array?Float32Array:Array,PIXI.Matrix}var root=this,PIXI=PIXI||{};PIXI.Point=function(t,e){this.x=t||0,this.y=e||0},PIXI.Point.prototype.clone=function(){return new PIXI.Point(this.x,this.y)},PIXI.Point.constructor=PIXI.Point,PIXI.Rectangle=function(t,e,i,r){this.x=t||0,this.y=e||0,this.width=i||0,this.height=r||0},PIXI.Rectangle.prototype.clone=function(){return new PIXI.Rectangle(this.x,this.y,this.width,this.height)},PIXI.Rectangle.constructor=PIXI.Rectangle,PIXI.DisplayObject=function(){this.position=new PIXI.Point,this.scale=new PIXI.Point(1,1),this.pivot=new PIXI.Point(0,0),this.rotation=0,this.alpha=1,this.visible=!0,this.worldVisible=!1,this.parent=null,this.stage=null,this.hitArea=null,this.worldAlpha=1,this.color=[],this.worldTransform=PIXI.mat3.create(),this.localTransform=PIXI.mat3.create(),this.dynamic=!0,this._sr=0,this._cr=1,this.childIndex=0,this.renderable=!1,this.interactive=!1,this.buttonMode=!1},PIXI.DisplayObject.constructor=PIXI.DisplayObject,PIXI.DisplayObject.prototype.setInteractive=function(t){this.interactive=t,this.stage&&(this.stage.dirty=!0)},PIXI.DisplayObject.prototype.updateTransform=function(){this.rotation!=this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var t=this.localTransform,e=this.parent.worldTransform,i=this.worldTransform;t[0]=this._cr*this.scale.x,t[1]=-this._sr*this.scale.y,t[3]=this._sr*this.scale.x,t[4]=this._cr*this.scale.y;var r=this.pivot.x,n=this.pivot.y;t[2]=this.position.x-t[0]*r-n*t[1],t[5]=this.position.y-t[4]*n-r*t[3];var o=t[0],s=t[1],a=t[2],h=t[3],c=t[4],u=t[5],l=e[0],d=e[1],p=e[2],f=e[3],I=e[4],y=e[5];i[0]=l*o+d*h,i[1]=l*s+d*c,i[2]=l*a+d*u+p,i[3]=f*o+I*h,i[4]=f*s+I*c,i[5]=f*a+I*u+y,this.worldAlpha=this.alpha*this.parent.worldAlpha},PIXI.DisplayObjectContainer=function(){PIXI.DisplayObject.call(this),this.children=[],this.renderable=!1},PIXI.DisplayObjectContainer.constructor=PIXI.DisplayObjectContainer,PIXI.DisplayObjectContainer.prototype=Object.create(PIXI.DisplayObject.prototype),PIXI.DisplayObjectContainer.prototype.addChild=function(t){void 0!=t.parent&&t.parent.removeChild(t),t.parent=this,t.childIndex=this.children.length,this.children.push(t),this.stage&&this.stage.__addChild(t),this.__renderGroup&&(t.__renderGroup&&t.__renderGroup.removeDisplayObjectAndChildren(t),this.__renderGroup.addDisplayObjectAndChildren(t))},PIXI.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(!(e>=0&&this.children.length>=e))throw Error(t+" The index "+e+" supplied is out of bounds "+this.children.length);void 0!=t.parent&&t.parent.removeChild(t),e==this.children.length?this.children.push(t):this.children.splice(e,0,t),t.parent=this,t.childIndex=e;for(var i=this.children.length,r=e;i>r;r++)this.children[r].childIndex=r;this.stage&&this.stage.__addChild(t),this.__renderGroup&&(t.__renderGroup&&t.__renderGroup.removeDisplayObjectAndChildren(t),this.__renderGroup.addDisplayObjectAndChildren(t))},PIXI.DisplayObjectContainer.prototype.swapChildren=function(t,e){var i=this.children.indexOf(t),r=this.children.indexOf(e);if(-1===i||-1===r)throw Error(t+" Both the supplied DisplayObjects must be a child of the caller "+this);this.stage&&(this.stage.__removeChild(t),this.stage.__removeChild(e),this.stage.__addChild(t),this.stage.__addChild(e)),t.childIndex=r,e.childIndex=i,this.children[i]=e,this.children[r]=t},PIXI.DisplayObjectContainer.prototype.getChildAt=function(t){if(t>=0&&this.children.length>t)return this.children[t];throw Error(child+" Both the supplied DisplayObjects must be a child of the caller "+this)},PIXI.DisplayObjectContainer.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1===e)throw Error(t+" The supplied DisplayObject must be a child of the caller "+this);this.stage&&this.stage.__removeChild(t),t.__renderGroup&&t.__renderGroup.removeDisplayObjectAndChildren(t),t.parent=void 0,this.children.splice(e,1);for(var i=e,r=this.children.length;r>i;i++)this.children[i].childIndex-=1},PIXI.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){PIXI.DisplayObject.prototype.updateTransform.call(this);for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform()}},PIXI.blendModes={},PIXI.blendModes.NORMAL=0,PIXI.blendModes.SCREEN=1,PIXI.Sprite=function(t){PIXI.DisplayObjectContainer.call(this),this.anchor=new PIXI.Point,this.texture=t,this.blendMode=PIXI.blendModes.NORMAL,this._width=0,this._height=0,t.baseTexture.hasLoaded?this.updateFrame=!0:(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},PIXI.Sprite.constructor=PIXI.Sprite,PIXI.Sprite.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),Object.defineProperty(PIXI.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(PIXI.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),PIXI.Sprite.prototype.setTexture=function(t){this.texture.baseTexture!=t.baseTexture&&(this.textureChange=!0),this.texture=t,this.updateFrame=!0},PIXI.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height),this.updateFrame=!0},PIXI.Sprite.fromFrame=function(t){var e=PIXI.TextureCache[t];if(!e)throw Error("The frameId '"+t+"' does not exist in the texture cache"+this);return new PIXI.Sprite(e)},PIXI.Sprite.fromImage=function(t){var e=PIXI.Texture.fromImage(t);return new PIXI.Sprite(e)},PIXI.MovieClip=function(t){PIXI.Sprite.call(this,t[0]),this.textures=t,this.currentFrame=0,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.playing},PIXI.MovieClip.constructor=PIXI.MovieClip,PIXI.MovieClip.prototype=Object.create(PIXI.Sprite.prototype),PIXI.MovieClip.prototype.stop=function(){this.playing=!1},PIXI.MovieClip.prototype.play=function(){this.playing=!0},PIXI.MovieClip.prototype.gotoAndStop=function(t){this.playing=!1,this.currentFrame=t;var e=0|this.currentFrame+.5;this.setTexture(this.textures[e%this.textures.length])},PIXI.MovieClip.prototype.gotoAndPlay=function(t){this.currentFrame=t,this.playing=!0},PIXI.MovieClip.prototype.updateTransform=function(){if(PIXI.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var t=0|this.currentFrame+.5;this.loop||this.textures.length>t?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},PIXI.Text=function(t,e){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),PIXI.Sprite.call(this,PIXI.Texture.fromCanvas(this.canvas)),this.setText(t),this.setStyle(e),this.updateText(),this.dirty=!1},PIXI.Text.constructor=PIXI.Text,PIXI.Text.prototype=Object.create(PIXI.Sprite.prototype),PIXI.Text.prototype.setStyle=function(t){t=t||{},t.font=t.font||"bold 20pt Arial",t.fill=t.fill||"black",t.align=t.align||"left",t.strokeThickness=t.strokeThickness||0,this.style=t,this.dirty=!0},PIXI.Sprite.prototype.setText=function(t){this.text=t||" ",this.dirty=!0},PIXI.Text.prototype.updateText=function(){this.context.font=this.style.font;for(var t=this.text.split(/(?:\r\n|\r|\n)/),e=[],i=0,r=0;t.length>r;r++){var n=this.context.measureText(t[r]).width;e[r]=n,i=Math.max(i,n)}this.canvas.width=i+this.style.strokeThickness;var o=this.determineFontHeight("font: "+this.style.font+";")+this.style.strokeThickness;for(this.canvas.height=o*t.length,this.context.fillStyle=this.style.fill,this.context.font=this.style.font,this.context.strokeStyle=this.style.stroke,this.context.lineWidth=this.style.strokeThickness,this.context.textBaseline="top",r=0;t.length>r;r++){var s=new PIXI.Point(this.style.strokeThickness/2,this.style.strokeThickness/2+r*o);"right"==this.style.align?s.x+=i-e[r]:"center"==this.style.align&&(s.x+=(i-e[r])/2),this.style.stroke&&this.style.strokeThickness&&this.context.strokeText(t[r],s.x,s.y),this.style.fill&&this.context.fillText(t[r],s.x,s.y)}this.updateTexture()},PIXI.Text.prototype.updateTexture=function(){this.texture.baseTexture.width=this.canvas.width,this.texture.baseTexture.height=this.canvas.height,this.texture.frame.width=this.canvas.width,this.texture.frame.height=this.canvas.height,this._width=this.canvas.width,this._height=this.canvas.height,PIXI.texturesToUpdate.push(this.texture.baseTexture)},PIXI.Text.prototype.updateTransform=function(){this.dirty&&(this.updateText(),this.dirty=!1),PIXI.Sprite.prototype.updateTransform.call(this)},PIXI.Text.prototype.determineFontHeight=function(t){var e=PIXI.Text.heightCache[t];if(!e){var i=document.getElementsByTagName("body")[0],r=document.createElement("div"),n=document.createTextNode("M");r.appendChild(n),r.setAttribute("style",t),i.appendChild(r),e=r.offsetHeight,PIXI.Text.heightCache[t]=e,i.removeChild(r)}return e},PIXI.Text.prototype.destroy=function(t){t&&this.texture.destroy()},PIXI.Text.heightCache={},PIXI.BitmapText=function(t,e){PIXI.DisplayObjectContainer.call(this),this.setText(t),this.setStyle(e),this.updateText(),this.dirty=!1},PIXI.BitmapText.constructor=PIXI.BitmapText,PIXI.BitmapText.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.BitmapText.prototype.setText=function(t){this.text=t||" ",this.dirty=!0},PIXI.BitmapText.prototype.setStyle=function(t){t=t||{},t.align=t.align||"left",this.style=t;var e=t.font.split(" ");this.fontName=e[e.length-1],this.fontSize=e.length>=2?parseInt(e[e.length-2],10):PIXI.BitmapText.fonts[this.fontName].size,this.dirty=!0},PIXI.BitmapText.prototype.updateText=function(){for(var t=PIXI.BitmapText.fonts[this.fontName],e=new PIXI.Point,i=null,r=[],n=0,o=[],s=0,a=this.fontSize/t.size,h=0;this.text.length>h;h++){var c=this.text.charCodeAt(h);if(/(?:\r\n|\r|\n)/.test(this.text.charAt(h)))o.push(e.x),n=Math.max(n,e.x),s++,e.x=0,e.y+=t.lineHeight,i=null;else{var u=t.chars[c];u&&(i&&u[i]&&(e.x+=u.kerning[i]),r.push({line:s,charCode:c,position:new PIXI.Point(e.x+u.xOffset,e.y+u.yOffset)}),e.x+=u.xAdvance,i=c)}}o.push(e.x),n=Math.max(n,e.x);var l=[];for(h=0;s>=h;h++){var d=0;"right"==this.style.align?d=n-o[h]:"center"==this.style.align&&(d=(n-o[h])/2),l.push(d)}for(h=0;r.length>h;h++){var p=PIXI.Sprite.fromFrame(r[h].charCode);p.position.x=(r[h].position.x+l[r[h].line])*a,p.position.y=r[h].position.y*a,p.scale.x=p.scale.y=a,this.addChild(p)}this.width=e.x*a,this.height=(e.y+t.lineHeight)*a},PIXI.BitmapText.prototype.updateTransform=function(){if(this.dirty){for(;this.children.length>0;)this.removeChild(this.getChildAt(0));this.updateText(),this.dirty=!1}PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},PIXI.BitmapText.fonts={},PIXI.InteractionManager=function(t){this.stage=t,this.tempPoint=new PIXI.Point,this.mouseoverEnabled=!0,this.mouse=new PIXI.InteractionData,this.touchs={},this.pool=[],this.interactiveItems=[],this.last=0
},PIXI.InteractionManager.constructor=PIXI.InteractionManager,PIXI.InteractionManager.prototype.collectInteractiveSprite=function(t,e){for(var i=t.children,r=i.length,n=r-1;n>=0;n--){var o=i[n];o.interactive?(e.interactiveChildren=!0,this.interactiveItems.push(o),o.children.length>0&&this.collectInteractiveSprite(o,o)):(o.__iParent=null,o.children.length>0&&this.collectInteractiveSprite(o,e))}},PIXI.InteractionManager.prototype.setTarget=function(t){window.navigator.msPointerEnabled&&(t.view.style["-ms-content-zooming"]="none",t.view.style["-ms-touch-action"]="none"),this.target=t,t.view.addEventListener("mousemove",this.onMouseMove.bind(this),!0),t.view.addEventListener("mousedown",this.onMouseDown.bind(this),!0),document.body.addEventListener("mouseup",this.onMouseUp.bind(this),!0),t.view.addEventListener("mouseout",this.onMouseUp.bind(this),!0),t.view.addEventListener("touchstart",this.onTouchStart.bind(this),!0),t.view.addEventListener("touchend",this.onTouchEnd.bind(this),!0),t.view.addEventListener("touchmove",this.onTouchMove.bind(this),!0)},PIXI.InteractionManager.prototype.update=function(){if(this.target){var t=Date.now(),e=t-this.last;if(e=30*e/1e3,!(1>e)){if(this.last=t,this.dirty){this.dirty=!1,this.interactiveItems.length;for(var i=0;this.interactiveItems.length>i;i++)this.interactiveItems[i].interactiveChildren=!1;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)}var r=this.interactiveItems.length;this.target.view.style.cursor="default";for(var i=0;r>i;i++){var n=this.interactiveItems[i];n.visible&&(n.mouseover||n.mouseout||n.buttonMode)&&(n.__hit=this.hitTest(n,this.mouse),n.__hit?(n.buttonMode&&(this.target.view.style.cursor="pointer"),n.__isOver||(n.mouseover&&n.mouseover(this.mouse),n.__isOver=!0)):n.__isOver&&(n.mouseout&&n.mouseout(this.mouse),n.__isOver=!1))}}}},PIXI.InteractionManager.prototype.onMouseMove=function(t){t.preventDefault();var e=this.target.view.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width),this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height);var i=this.interactiveItems.length;this.mouse.global;for(var r=0;i>r;r++){var n=this.interactiveItems[r];n.mousemove&&n.mousemove(this.mouse)}},PIXI.InteractionManager.prototype.onMouseDown=function(t){t.preventDefault();var e=this.interactiveItems.length;this.mouse.global,this.stage;for(var i=0;e>i;i++){var r=this.interactiveItems[i];if((r.mousedown||r.click)&&(r.__mouseIsDown=!0,r.__hit=this.hitTest(r,this.mouse),r.__hit&&(r.mousedown&&r.mousedown(this.mouse),r.__isDown=!0,!r.interactiveChildren)))break}},PIXI.InteractionManager.prototype.onMouseUp=function(t){t.preventDefault(),this.mouse.global;for(var e=this.interactiveItems.length,i=!1,r=0;e>r;r++){var n=this.interactiveItems[r];(n.mouseup||n.mouseupoutside||n.click)&&(n.__hit=this.hitTest(n,this.mouse),n.__hit&&!i?(n.mouseup&&n.mouseup(this.mouse),n.__isDown&&n.click&&n.click(this.mouse),n.interactiveChildren||(i=!0)):n.__isDown&&n.mouseupoutside&&n.mouseupoutside(this.mouse),n.__isDown=!1)}},PIXI.InteractionManager.prototype.hitTest=function(t,e){var i=e.global;if(!t.visible)return!1;if(t instanceof PIXI.Sprite){var r=t.worldTransform,n=r[0],o=r[1],s=r[2],a=r[3],h=r[4],c=r[5],u=1/(n*h+o*-a),l=h*u*i.x+-o*u*i.y+(c*o-s*h)*u,d=n*u*i.y+-a*u*i.x+(-c*n+s*a)*u,p=t.texture.frame.width,f=t.texture.frame.height,I=-p*t.anchor.x;if(l>I&&I+p>l){var y=-f*t.anchor.y;if(d>y&&y+f>d)return e.target=t,!0}}else if(t.hitArea){var r=t.worldTransform,v=t.hitArea,n=r[0],o=r[1],s=r[2],a=r[3],h=r[4],c=r[5],u=1/(n*h+o*-a),l=h*u*i.x+-o*u*i.y+(c*o-s*h)*u,d=n*u*i.y+-a*u*i.x+(-c*n+s*a)*u,I=v.x;if(l>I&&I+v.width>l){var y=v.y;if(d>y&&y+v.height>d)return!0}}for(var g=t.children.length,b=0;g>b;b++){var m=t.children[b],x=this.hitTest(m,e);if(x)return!0}return!1},PIXI.InteractionManager.prototype.onTouchMove=function(t){t.preventDefault();for(var e=this.target.view.getBoundingClientRect(),i=t.changedTouches,r=0;i.length>r;r++){var n=i[r],o=this.touchs[n.identifier];o.global.x=(n.clientX-e.left)*(this.target.width/e.width),o.global.y=(n.clientY-e.top)*(this.target.height/e.height)}for(var s=this.interactiveItems.length,r=0;s>r;r++){var a=this.interactiveItems[r];a.touchmove&&a.touchmove(o)}},PIXI.InteractionManager.prototype.onTouchStart=function(t){t.preventDefault();for(var e=this.target.view.getBoundingClientRect(),i=t.changedTouches,r=0;i.length>r;r++){var n=i[r],o=this.pool.pop();o||(o=new PIXI.InteractionData),this.touchs[n.identifier]=o,o.global.x=(n.clientX-e.left)*(this.target.width/e.width),o.global.y=(n.clientY-e.top)*(this.target.height/e.height);for(var s=this.interactiveItems.length,a=0;s>a;a++){var h=this.interactiveItems[a];if((h.touchstart||h.tap)&&(h.__hit=this.hitTest(h,o),h.__hit&&(h.touchstart&&h.touchstart(o),h.__isDown=!0,h.__touchData=o,!h.interactiveChildren)))break}}},PIXI.InteractionManager.prototype.onTouchEnd=function(t){t.preventDefault();for(var e=this.target.view.getBoundingClientRect(),i=t.changedTouches,r=0;i.length>r;r++){var n=i[r],o=this.touchs[n.identifier],s=!1;o.global.x=(n.clientX-e.left)*(this.target.width/e.width),o.global.y=(n.clientY-e.top)*(this.target.height/e.height);for(var a=this.interactiveItems.length,h=0;a>h;h++){var c=this.interactiveItems[h],u=c.__touchData;c.__hit=this.hitTest(c,o),u==o&&((c.touchend||c.tap)&&(c.__hit&&!s?(c.touchend&&c.touchend(o),c.__isDown&&c.tap&&c.tap(o),c.interactiveChildren||(s=!0)):c.__isDown&&c.touchendoutside&&c.touchendoutside(o),c.__isDown=!1),c.__touchData=null)}this.pool.push(o),this.touchs[n.identifier]=null}},PIXI.InteractionData=function(){this.global=new PIXI.Point,this.local=new PIXI.Point,this.target},PIXI.InteractionData.prototype.getLocalPosition=function(t){var e=t.worldTransform,i=this.global,r=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=1/(r*a+n*-s);return new PIXI.Point(a*c*i.x+-n*c*i.y+(h*n-o*a)*c,r*c*i.y+-s*c*i.x+(-h*r+o*s)*c)},PIXI.InteractionData.constructor=PIXI.InteractionData,PIXI.Stage=function(t,e){PIXI.DisplayObjectContainer.call(this),this.worldTransform=PIXI.mat3.create(),this.__childrenAdded=[],this.__childrenRemoved=[],this.childIndex=0,this.stage=this,this.stage.hitArea=new PIXI.Rectangle(0,0,1e5,1e5),this.interactive=!!e,this.interactionManager=new PIXI.InteractionManager(this),this.setBackgroundColor(t),this.worldVisible=!0},PIXI.Stage.constructor=PIXI.Stage,PIXI.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},PIXI.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=HEXtoRGB(this.backgroundColor),this.backgroundColorString="#"+this.backgroundColor.toString(16)},PIXI.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},PIXI.Stage.prototype.__addChild=function(t){if(t.interactive&&(this.dirty=!0),t.stage=this,t.children)for(var e=0;t.children.length>e;e++)this.__addChild(t.children[e])},PIXI.Stage.prototype.__removeChild=function(t){if(t.interactive&&(this.dirty=!0),t.stage=void 0,t.children)for(var e=0,i=t.children.length;i>e;e++)this.__removeChild(t.children[e])},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var t=Array.prototype.slice;return function(e){function i(){var o=n.concat(t.call(arguments));r.apply(this instanceof i?this:e,o)}var r=this,n=t.call(arguments,1);if("function"!=typeof r)throw new TypeError;return i.prototype=function o(t){return t&&(o.prototype=t),this instanceof o?void 0:new o}(r.prototype),i}}());var AjaxRequest=function(){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new XMLHttpRequest:!1;for(var e=0;t.length>e;e++)try{return new ActiveXObject(t[e])}catch(i){}};PIXI.EventTarget=function(){var t={};this.addEventListener=this.on=function(e,i){void 0===t[e]&&(t[e]=[]),-1===t[e].indexOf(i)&&t[e].push(i)},this.dispatchEvent=this.emit=function(e){for(var i in t[e.type])t[e.type][i](e)},this.removeEventListener=this.off=function(e,i){var r=t[e].indexOf(i);-1!==r&&t[e].splice(r,1)}},determineMatrixArrayType(),PIXI.mat3={},PIXI.mat3.create=function(){var t=new PIXI.Matrix(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},PIXI.mat4={},PIXI.mat4.create=function(){var t=new PIXI.Matrix(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},PIXI.mat3.multiply=function(t,e,i){i||(i=t);var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],h=t[5],c=t[6],u=t[7],l=t[8],d=e[0],p=e[1],f=e[2],I=e[3],y=e[4],v=e[5],g=e[6],b=e[7],m=e[8];return i[0]=d*r+p*s+f*c,i[1]=d*n+p*a+f*u,i[2]=d*o+p*h+f*l,i[3]=I*r+y*s+v*c,i[4]=I*n+y*a+v*u,i[5]=I*o+y*h+v*l,i[6]=g*r+b*s+m*c,i[7]=g*n+b*a+m*u,i[8]=g*o+b*h+m*l,i},PIXI.mat3.toMat4=function(t,e){return e||(e=PIXI.mat4.create()),e[15]=1,e[14]=0,e[13]=0,e[12]=0,e[11]=0,e[10]=t[8],e[9]=t[7],e[8]=t[6],e[7]=0,e[6]=t[5],e[5]=t[4],e[4]=t[3],e[3]=0,e[2]=t[2],e[1]=t[1],e[0]=t[0],e},PIXI.mat4.create=function(){var t=new PIXI.Matrix(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},PIXI.mat4.transpose=function(t,e){if(!e||t===e){var i=t[1],r=t[2],n=t[3],o=t[6],s=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=i,t[6]=t[9],t[7]=t[13],t[8]=r,t[9]=o,t[11]=t[14],t[12]=n,t[13]=s,t[14]=a,t}return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},PIXI.mat4.multiply=function(t,e,i){i||(i=t);var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],h=t[5],c=t[6],u=t[7],l=t[8],d=t[9],p=t[10],f=t[11],I=t[12],y=t[13],v=t[14],g=t[15],b=e[0],m=e[1],x=e[2],P=e[3];return i[0]=b*r+m*a+x*l+P*I,i[1]=b*n+m*h+x*d+P*y,i[2]=b*o+m*c+x*p+P*v,i[3]=b*s+m*u+x*f+P*g,b=e[4],m=e[5],x=e[6],P=e[7],i[4]=b*r+m*a+x*l+P*I,i[5]=b*n+m*h+x*d+P*y,i[6]=b*o+m*c+x*p+P*v,i[7]=b*s+m*u+x*f+P*g,b=e[8],m=e[9],x=e[10],P=e[11],i[8]=b*r+m*a+x*l+P*I,i[9]=b*n+m*h+x*d+P*y,i[10]=b*o+m*c+x*p+P*v,i[11]=b*s+m*u+x*f+P*g,b=e[12],m=e[13],x=e[14],P=e[15],i[12]=b*r+m*a+x*l+P*I,i[13]=b*n+m*h+x*d+P*y,i[14]=b*o+m*c+x*p+P*v,i[15]=b*s+m*u+x*f+P*g,i},PIXI.autoDetectRenderer=function(t,e,i,r){t||(t=800),e||(e=600);var n=function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(t){return!1}}();return n?new PIXI.WebGLRenderer(t,e,i,r):new PIXI.CanvasRenderer(t,e,i,r)},PIXI.shaderFragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","gl_FragColor = gl_FragColor * vColor;","}"],PIXI.shaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat4 uMVMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void) {","gl_Position = uMVMatrix * vec4(aVertexPosition, 1.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;","}"],PIXI.CompileVertexShader=function(t,e){return PIXI._CompileShader(t,e,t.VERTEX_SHADER)},PIXI.CompileFragmentShader=function(t,e){return PIXI._CompileShader(t,e,t.FRAGMENT_SHADER)},PIXI._CompileShader=function(t,e,i){var r=e.join("\n"),n=t.createShader(i);return t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert(t.getShaderInfoLog(n)),null)},PIXI._defaultFrame=new PIXI.Rectangle(0,0,1,1),PIXI.gl,PIXI.WebGLRenderer=function(t,e,i,r){this.transparent=!!r,this.width=t||800,this.height=e||600,this.view=i||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height;var n=this;this.view.addEventListener("webglcontextlost",function(t){n.handleContextLost(t)},!1),this.view.addEventListener("webglcontextrestored",function(t){n.handleContextRestored(t)},!1),this.batchs=[];try{PIXI.gl=this.gl=this.view.getContext("experimental-webgl",{alpha:this.transparent,antialias:!1,premultipliedAlpha:!0})}catch(o){throw Error(" This browser does not support webGL. Try using the canvas renderer"+this)}this.initShaders();var s=this.gl;PIXI.WebGLRenderer.gl=s,this.batch=new PIXI.WebGLBatch(s),s.disable(s.DEPTH_TEST),s.disable(s.CULL_FACE),s.enable(s.BLEND),s.colorMask(!0,!0,!0,this.transparent),this.projectionMatrix=PIXI.mat4.create(),this.resize(this.width,this.height),this.contextLost=!1,this.stageRenderGroup=new PIXI.WebGLRenderGroup(this.gl)},PIXI.WebGLRenderer.constructor=PIXI.WebGLRenderer,PIXI.WebGLRenderer.getBatch=function(){return 0==PIXI._batchs.length?new PIXI.WebGLBatch(PIXI.WebGLRenderer.gl):PIXI._batchs.pop()},PIXI.WebGLRenderer.returnBatch=function(t){t.clean(),PIXI._batchs.push(t)},PIXI.WebGLRenderer.prototype.initShaders=function(){var t=this.gl,e=PIXI.CompileFragmentShader(t,PIXI.shaderFragmentSrc),i=PIXI.CompileVertexShader(t,PIXI.shaderVertexSrc);PIXI.shaderProgram=t.createProgram();var r=PIXI.shaderProgram;t.attachShader(r,i),t.attachShader(r,e),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)||alert("Could not initialise shaders"),t.useProgram(r),r.vertexPositionAttribute=t.getAttribLocation(r,"aVertexPosition"),t.enableVertexAttribArray(r.vertexPositionAttribute),r.textureCoordAttribute=t.getAttribLocation(r,"aTextureCoord"),t.enableVertexAttribArray(r.textureCoordAttribute),r.colorAttribute=t.getAttribLocation(r,"aColor"),t.enableVertexAttribArray(r.colorAttribute),r.mvMatrixUniform=t.getUniformLocation(r,"uMVMatrix"),r.samplerUniform=t.getUniformLocation(r,"uSampler")},PIXI.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(this.__stage=t,this.stageRenderGroup.setRenderable(t)),PIXI.WebGLRenderer.updateTextures(),t.updateTransform();var e=this.gl;if(e.colorMask(!0,!0,!0,this.transparent),e.viewport(0,0,this.width,this.height),e.bindFramebuffer(e.FRAMEBUFFER,null),e.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],this.transparent),e.clear(e.COLOR_BUFFER_BIT),this.stageRenderGroup.backgroundColor=t.backgroundColorSplit,this.stageRenderGroup.render(this.projectionMatrix),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),PIXI.Texture.frameUpdates.length>0){for(var i=0;PIXI.Texture.frameUpdates.length>i;i++)PIXI.Texture.frameUpdates[i].updateFrame=!1;PIXI.Texture.frameUpdates=[]}}},PIXI.WebGLRenderer.updateTextures=function(){for(var t=0;PIXI.texturesToUpdate.length>t;t++)this.updateTexture(PIXI.texturesToUpdate[t]);for(var t=0;PIXI.texturesToDestroy.length>t;t++)this.destroyTexture(PIXI.texturesToDestroy[t]);PIXI.texturesToUpdate=[],PIXI.texturesToDestroy=[]},PIXI.WebGLRenderer.updateTexture=function(t){var e=PIXI.gl;t._glTexture||(t._glTexture=e.createTexture()),t.hasLoaded&&(e.bindTexture(e.TEXTURE_2D,t._glTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.bindTexture(e.TEXTURE_2D,null))},PIXI.WebGLRenderer.prototype.destroyTexture=function(t){var e=this.gl;t._glTexture&&(t._glTexture=e.createTexture(),e.deleteTexture(e.TEXTURE_2D,t._glTexture))},PIXI.WebGLRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e,this.gl.viewport(0,0,this.width,this.height);var i=this.projectionMatrix;i[0]=2/this.width,i[5]=-2/this.height,i[12]=-1,i[13]=1},PIXI.WebGLRenderer.prototype.handleContextLost=function(t){t.preventDefault(),this.contextLost=!0},PIXI.WebGLRenderer.prototype.handleContextRestored=function(){this.gl=this.view.getContext("experimental-webgl",{alpha:!0}),this.initShaders();for(var t=0;PIXI.TextureCache.length>t;t++)this.updateTexture(PIXI.TextureCache[t]);for(var t=0;this.batchs.length>t;t++)this.batchs[t].restoreLostContext(this.gl),this.batchs[t].dirty=!0;PIXI._restoreBatchs(this.gl),this.contextLost=!1},PIXI._batchs=[],PIXI._getBatch=function(t){return 0==PIXI._batchs.length?new PIXI.WebGLBatch(t):PIXI._batchs.pop()},PIXI._returnBatch=function(t){t.clean(),PIXI._batchs.push(t)},PIXI._restoreBatchs=function(t){for(var e=0;PIXI._batchs.length>e;e++)PIXI._batchs[e].restoreLostContext(t)},PIXI.WebGLBatch=function(t){this.gl=t,this.size=0,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.blendMode=PIXI.blendModes.NORMAL,this.dynamicSize=1},PIXI.WebGLBatch.constructor=PIXI.WebGLBatch,PIXI.WebGLBatch.prototype.clean=function(){this.verticies=[],this.uvs=[],this.indices=[],this.colors=[],this.dynamicSize=1,this.texture=null,this.last=null,this.size=0,this.head,this.tail},PIXI.WebGLBatch.prototype.restoreLostContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer()},PIXI.WebGLBatch.prototype.init=function(t){t.batch=this,this.dirty=!0,this.blendMode=t.blendMode,this.texture=t.texture.baseTexture,this.head=t,this.tail=t,this.size=1,this.growBatch()},PIXI.WebGLBatch.prototype.insertBefore=function(t,e){this.size++,t.batch=this,this.dirty=!0;var i=e.__prev;e.__prev=t,t.__next=e,i?(t.__prev=i,i.__next=t):this.head=t},PIXI.WebGLBatch.prototype.insertAfter=function(t,e){this.size++,t.batch=this,this.dirty=!0;var i=e.__next;e.__next=t,t.__prev=e,i?(t.__next=i,i.__prev=t):this.tail=t},PIXI.WebGLBatch.prototype.remove=function(t){return this.size--,0==this.size?(t.batch=null,t.__prev=null,t.__next=null,void 0):(t.__prev?t.__prev.__next=t.__next:(this.head=t.__next,this.head.__prev=null),t.__next?t.__next.__prev=t.__prev:(this.tail=t.__prev,this.tail.__next=null),t.batch=null,t.__next=null,t.__prev=null,this.dirty=!0,void 0)},PIXI.WebGLBatch.prototype.split=function(t){this.dirty=!0;var e=new PIXI.WebGLBatch(this.gl);e.init(t),e.tail=this.tail,this.tail=t.__prev,this.tail.__next=null,t.__prev=null;for(var i=0;t;)i++,t.batch=e,t=t.__next;return e.size=i,this.size-=i,e},PIXI.WebGLBatch.prototype.merge=function(t){this.dirty=!0,this.tail.__next=t.head,t.head.__prev=this.tail,this.size+=t.size,this.tail=t.tail;for(var e=t.head;e;)e.batch=this,e=e.__next},PIXI.WebGLBatch.prototype.growBatch=function(){var t=this.gl;this.dynamicSize=1==this.size?1:1.5*this.size,this.verticies=new Float32Array(8*this.dynamicSize),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.verticies,t.DYNAMIC_DRAW),this.uvs=new Float32Array(8*this.dynamicSize),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.DYNAMIC_DRAW),this.dirtyUVS=!0,this.colors=new Float32Array(4*this.dynamicSize),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors,t.DYNAMIC_DRAW),this.dirtyColors=!0,this.indices=new Uint16Array(6*this.dynamicSize);for(var e=this.indices.length/6,i=0;e>i;i++){var r=6*i,n=4*i;this.indices[r+0]=n+0,this.indices[r+1]=n+1,this.indices[r+2]=n+2,this.indices[r+3]=n+0,this.indices[r+4]=n+2,this.indices[r+5]=n+3}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)},PIXI.WebGLBatch.prototype.refresh=function(){this.gl,this.dynamicSize<this.size&&this.growBatch();for(var t,e=0,i=this.head;i;){t=8*e;var r=i.texture,n=r.frame,o=r.baseTexture.width,s=r.baseTexture.height;this.uvs[t+0]=n.x/o,this.uvs[t+1]=n.y/s,this.uvs[t+2]=(n.x+n.width)/o,this.uvs[t+3]=n.y/s,this.uvs[t+4]=(n.x+n.width)/o,this.uvs[t+5]=(n.y+n.height)/s,this.uvs[t+6]=n.x/o,this.uvs[t+7]=(n.y+n.height)/s,i.updateFrame=!1,colorIndex=4*e,this.colors[colorIndex]=this.colors[colorIndex+1]=this.colors[colorIndex+2]=this.colors[colorIndex+3]=i.worldAlpha,i=i.__next,e++}this.dirtyUVS=!0,this.dirtyColors=!0},PIXI.WebGLBatch.prototype.update=function(){this.gl;for(var t,e,i,r,n,o,s,a,h,c,u,l,d,p,f,I,y=0,v=this.head;v;){if(v.worldVisible){if(e=v.texture.frame.width,i=v.texture.frame.height,r=v.anchor.x,n=v.anchor.y,o=e*(1-r),s=e*-r,a=i*(1-n),h=i*-n,c=8*y,t=v.worldTransform,u=t[0],l=t[3],d=t[1],p=t[4],f=t[2],I=t[5],this.verticies[c+0]=u*s+d*h+f,this.verticies[c+1]=p*h+l*s+I,this.verticies[c+2]=u*o+d*h+f,this.verticies[c+3]=p*h+l*o+I,this.verticies[c+4]=u*o+d*a+f,this.verticies[c+5]=p*a+l*o+I,this.verticies[c+6]=u*s+d*a+f,this.verticies[c+7]=p*a+l*s+I,v.updateFrame||v.texture.updateFrame){this.dirtyUVS=!0;var g=v.texture,b=g.frame,m=g.baseTexture.width,x=g.baseTexture.height;this.uvs[c+0]=b.x/m,this.uvs[c+1]=b.y/x,this.uvs[c+2]=(b.x+b.width)/m,this.uvs[c+3]=b.y/x,this.uvs[c+4]=(b.x+b.width)/m,this.uvs[c+5]=(b.y+b.height)/x,this.uvs[c+6]=b.x/m,this.uvs[c+7]=(b.y+b.height)/x,v.updateFrame=!1}if(v.cacheAlpha!=v.worldAlpha){v.cacheAlpha=v.worldAlpha;var P=4*y;this.colors[P]=this.colors[P+1]=this.colors[P+2]=this.colors[P+3]=v.worldAlpha,this.dirtyColors=!0}}else c=8*y,this.verticies[c+0]=0,this.verticies[c+1]=0,this.verticies[c+2]=0,this.verticies[c+3]=0,this.verticies[c+4]=0,this.verticies[c+5]=0,this.verticies[c+6]=0,this.verticies[c+7]=0;y++,v=v.__next}},PIXI.WebGLBatch.prototype.render=function(t,e){if(t=t||0,void 0==e&&(e=this.size),this.dirty&&(this.refresh(),this.dirty=!1),0!=this.size){this.update();var i=this.gl;i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA);var r=PIXI.shaderProgram;i.useProgram(r),i.bindBuffer(i.ARRAY_BUFFER,this.vertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,this.verticies),i.vertexAttribPointer(r.vertexPositionAttribute,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,this.uvBuffer),this.dirtyUVS&&(this.dirtyUVS=!1,i.bufferSubData(i.ARRAY_BUFFER,0,this.uvs)),i.vertexAttribPointer(r.textureCoordAttribute,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,this.texture._glTexture),i.bindBuffer(i.ARRAY_BUFFER,this.colorBuffer),this.dirtyColors&&(this.dirtyColors=!1,i.bufferSubData(i.ARRAY_BUFFER,0,this.colors)),i.vertexAttribPointer(r.colorAttribute,1,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,this.indexBuffer);var n=e-t;i.drawElements(i.TRIANGLES,6*n,i.UNSIGNED_SHORT,6*2*t)}},PIXI.WebGLRenderGroup=function(t){this.gl=t,this.root,this.backgroundColor,this.batchs=[],this.toRemove=[]},PIXI.WebGLRenderGroup.constructor=PIXI.WebGLRenderGroup,PIXI.WebGLRenderGroup.prototype.setRenderable=function(t){this.root&&this.removeDisplayObjectAndChildren(this.root),t.worldVisible=t.visible,this.root=t,this.addDisplayObjectAndChildren(t)},PIXI.WebGLRenderGroup.prototype.render=function(t){PIXI.WebGLRenderer.updateTextures();var e=this.gl;e.uniformMatrix4fv(PIXI.shaderProgram.mvMatrixUniform,!1,t),this.checkVisibility(this.root,this.root.visible);for(var i,r=0;this.batchs.length>r;r++)i=this.batchs[r],i instanceof PIXI.WebGLBatch?this.batchs[r].render():i instanceof PIXI.TilingSprite?i.visible&&this.renderTilingSprite(i,t):i instanceof PIXI.Strip&&i.visible&&this.renderStrip(i,t)},PIXI.WebGLRenderGroup.prototype.renderSpecific=function(t,e){PIXI.WebGLRenderer.updateTextures();var i=this.gl;this.checkVisibility(t,t.visible),i.uniformMatrix4fv(PIXI.shaderProgram.mvMatrixUniform,!1,e);var r,n,o,s,a=t.renderable?t:this.getNextRenderable(t),h=a.batch;if(a instanceof PIXI.Sprite){h=a.batch;var c=h.head;if(c==a)r=0;else for(r=1;c.__next!=a;)r++,c=c.__next}else h=a;for(var u,l=t,d=t;d.children.length>0;)d=d.children[d.children.length-1],d.renderable&&(l=d);if(l instanceof PIXI.Sprite){u=l.batch;var c=u.head;if(c==l)o=0;else for(o=1;c.__next!=l;)o++,c=c.__next}else u=l;if(h==u)return h instanceof PIXI.WebGLBatch?h.render(r,o+1):h instanceof PIXI.TilingSprite?h.visible&&this.renderTilingSprite(h,e):h instanceof PIXI.Strip?h.visible&&this.renderStrip(h,e):h instanceof PIXI.CustomRenderable&&h.visible&&h.renderWebGL(this,e),void 0;n=this.batchs.indexOf(h),s=this.batchs.indexOf(u),h instanceof PIXI.WebGLBatch?h.render(r):h instanceof PIXI.TilingSprite?h.visible&&this.renderTilingSprite(h,e):h instanceof PIXI.Strip?h.visible&&this.renderStrip(h,e):h instanceof PIXI.CustomRenderable&&h.visible&&h.renderWebGL(this,e);for(var p=n+1;s>p;p++)renderable=this.batchs[p],renderable instanceof PIXI.WebGLBatch?this.batchs[p].render():renderable instanceof PIXI.TilingSprite?renderable.visible&&this.renderTilingSprite(renderable,e):renderable instanceof PIXI.Strip?renderable.visible&&this.renderStrip(renderable,e):renderable instanceof PIXI.CustomRenderable&&renderable.visible&&renderable.renderWebGL(this,e);u instanceof PIXI.WebGLBatch?u.render(0,o+1):u instanceof PIXI.TilingSprite?u.visible&&this.renderTilingSprite(u):u instanceof PIXI.Strip?u.visible&&this.renderStrip(u):u instanceof PIXI.CustomRenderable&&u.visible&&u.renderWebGL(this,e)},PIXI.WebGLRenderGroup.prototype.checkVisibility=function(t,e){for(var i=t.children,r=0;i.length>r;r++){var n=i[r];n.worldVisible=n.visible&&e,n.textureChange&&(n.textureChange=!1,n.worldVisible&&(this.removeDisplayObject(n),this.addDisplayObject(n))),n.children.length>0&&this.checkVisibility(n,n.worldVisible)}},PIXI.WebGLRenderGroup.prototype.addDisplayObject=function(t){if(t.__renderGroup&&t.__renderGroup.removeDisplayObjectAndChildren(t),t.__renderGroup=this,t.renderable){var e=this.getPreviousRenderable(t),i=this.getNextRenderable(t);if(t instanceof PIXI.Sprite){var r,n;if(e instanceof PIXI.Sprite){if(r=e.batch,r&&r.texture==t.texture.baseTexture&&r.blendMode==t.blendMode)return r.insertAfter(t,e),void 0}else r=e;if(i)if(i instanceof PIXI.Sprite){if(n=i.batch){if(n.texture==t.texture.baseTexture&&n.blendMode==t.blendMode)return n.insertBefore(t,i),void 0;if(n==r){var o=r.split(i),s=PIXI.WebGLRenderer.getBatch(),a=this.batchs.indexOf(r);return s.init(t),this.batchs.splice(a+1,0,s,o),void 0}}}else n=i;var s=PIXI.WebGLRenderer.getBatch();if(s.init(t),r){var a=this.batchs.indexOf(r);this.batchs.splice(a+1,0,s)}else this.batchs.push(s)}else t instanceof PIXI.TilingSprite?(this.initTilingSprite(t),this.batchs.push(t)):t instanceof PIXI.Strip&&(this.initStrip(t),this.batchs.push(t));this.batchUpdate=!0}},PIXI.WebGLRenderGroup.prototype.addDisplayObjectAndChildren=function(t){this.addDisplayObject(t);for(var e=t.children,i=0;e.length>i;i++)this.addDisplayObjectAndChildren(e[i])},PIXI.WebGLRenderGroup.prototype.removeDisplayObject=function(t){if(t.__renderGroup=null,t.renderable){var e;if(t instanceof PIXI.Sprite){var i=t.batch;if(!i)return;i.remove(t),0==i.size&&(e=i)}else e=t;if(e){var r=this.batchs.indexOf(e);if(-1==r)return;if(0==r||r==this.batchs.length-1)return this.batchs.splice(r,1),e instanceof PIXI.WebGLBatch&&PIXI.WebGLRenderer.returnBatch(e),void 0;if(this.batchs[r-1]instanceof PIXI.WebGLBatch&&this.batchs[r+1]instanceof PIXI.WebGLBatch&&this.batchs[r-1].texture==this.batchs[r+1].texture&&this.batchs[r-1].blendMode==this.batchs[r+1].blendMode)return this.batchs[r-1].merge(this.batchs[r+1]),e instanceof PIXI.WebGLBatch&&PIXI.WebGLRenderer.returnBatch(e),PIXI.WebGLRenderer.returnBatch(this.batchs[r+1]),this.batchs.splice(r,2),void 0;this.batchs.splice(r,1),e instanceof PIXI.WebGLBatch&&PIXI.WebGLRenderer.returnBatch(e)}}},PIXI.WebGLRenderGroup.prototype.removeDisplayObjectAndChildren=function(t){if(t.__renderGroup==this){this.removeDisplayObject(t);for(var e=t.children,i=0;e.length>i;i++)this.removeDisplayObjectAndChildren(e[i])}},PIXI.WebGLRenderGroup.prototype.getNextRenderable=function(t){var e=t;do{if(0==e.children.length){if(!e.parent)return null;for(;e.childIndex==e.parent.children.length-1;)if(e=e.parent,e==this.root||!e.parent){e=null;break}e&&(e=e.parent.children[e.childIndex+1])}else e=e.children[0];if(!e)break}while(!e.renderable||!e.__renderGroup);return e},PIXI.WebGLRenderGroup.prototype.getPreviousRenderable=function(t){var e=t;do{if(0==e.childIndex){if(e=e.parent,!e)return null}else for(e=e.parent.children[e.childIndex-1];0!=e.children.length;)e=e.children[e.children.length-1];if(e==this.root)break}while(!e.renderable||!e.__renderGroup);return e},PIXI.WebGLRenderGroup.prototype.initTilingSprite=function(t){var e=this.gl;t.verticies=new Float32Array([0,0,t.width,0,t.width,t.height,0,t.height]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.colors=new Float32Array([1,1,1,1]),t.indices=new Uint16Array([0,1,3,2]),t._vertexBuffer=e.createBuffer(),t._indexBuffer=e.createBuffer(),t._uvBuffer=e.createBuffer(),t._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.verticies,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW),t.texture.baseTexture._glTexture?(e.bindTexture(e.TEXTURE_2D,t.texture.baseTexture._glTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),t.texture.baseTexture._powerOf2=!0):t.texture.baseTexture._powerOf2=!0},PIXI.WebGLRenderGroup.prototype.renderStrip=function(t,e){var i=this.gl,r=PIXI.shaderProgram,n=PIXI.mat3.toMat4(t.worldTransform);PIXI.mat4.transpose(n),PIXI.mat4.multiply(e,n,n),i.uniformMatrix4fv(r.mvMatrixUniform,!1,n),t.blendMode==PIXI.blendModes.NORMAL?i.blendFunc(i.ONE,i.ONE_MINUS_SRC_ALPHA):i.blendFunc(i.ONE,i.ONE_MINUS_SRC_COLOR),t.dirty?(t.dirty=!1,i.bindBuffer(i.ARRAY_BUFFER,t._vertexBuffer),i.bufferData(i.ARRAY_BUFFER,t.verticies,i.STATIC_DRAW),i.vertexAttribPointer(r.vertexPositionAttribute,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.bufferData(i.ARRAY_BUFFER,t.uvs,i.STATIC_DRAW),i.vertexAttribPointer(r.textureCoordAttribute,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t.texture.baseTexture._glTexture),i.bindBuffer(i.ARRAY_BUFFER,t._colorBuffer),i.bufferData(i.ARRAY_BUFFER,t.colors,i.STATIC_DRAW),i.vertexAttribPointer(r.colorAttribute,1,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t._indexBuffer),i.bufferData(i.ELEMENT_ARRAY_BUFFER,t.indices,i.STATIC_DRAW)):(i.bindBuffer(i.ARRAY_BUFFER,t._vertexBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,t.verticies),i.vertexAttribPointer(r.vertexPositionAttribute,2,i.FLOAT,!1,0,0),i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.vertexAttribPointer(r.textureCoordAttribute,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,t.texture.baseTexture._glTexture),i.bindBuffer(i.ARRAY_BUFFER,t._colorBuffer),i.vertexAttribPointer(r.colorAttribute,1,i.FLOAT,!1,0,0),i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,t._indexBuffer)),i.drawElements(i.TRIANGLE_STRIP,t.indices.length,i.UNSIGNED_SHORT,0),i.uniformMatrix4fv(r.mvMatrixUniform,!1,e)},PIXI.WebGLRenderGroup.prototype.renderTilingSprite=function(t,e){var i=this.gl;PIXI.shaderProgram;var r=t.tilePosition,n=t.tileScale,o=r.x/t.texture.baseTexture.width,s=r.y/t.texture.baseTexture.height,a=t.width/t.texture.baseTexture.width/n.x,h=t.height/t.texture.baseTexture.height/n.y;t.uvs[0]=0-o,t.uvs[1]=0-s,t.uvs[2]=1*a-o,t.uvs[3]=0-s,t.uvs[4]=1*a-o,t.uvs[5]=1*h-s,t.uvs[6]=0-o,t.uvs[7]=1*h-s,i.bindBuffer(i.ARRAY_BUFFER,t._uvBuffer),i.bufferSubData(i.ARRAY_BUFFER,0,t.uvs),this.renderStrip(t,e)},PIXI.WebGLRenderer.prototype.initStrip=function(t){var e=this.gl;this.shaderProgram,t._vertexBuffer=e.createBuffer(),t._indexBuffer=e.createBuffer(),t._uvBuffer=e.createBuffer(),t._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.verticies,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW)
},PIXI.CanvasRenderer=function(t,e,i,r){this.transparent=r,this.width=t||800,this.height=e||600,this.refresh=!0,this.view=i||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.count=0,this.context=this.view.getContext("2d")},PIXI.CanvasRenderer.constructor=PIXI.CanvasRenderer,PIXI.CanvasRenderer.prototype.render=function(t){PIXI.texturesToUpdate=[],PIXI.texturesToDestroy=[],t.updateTransform(),this.view.style.backgroundColor==t.backgroundColorString||this.transparent||(this.view.style.backgroundColor=t.backgroundColorString),this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),PIXI.Texture.frameUpdates.length>0&&(PIXI.Texture.frameUpdates=[])},PIXI.CanvasRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e},PIXI.CanvasRenderer.prototype.renderDisplayObject=function(t){var e=t.worldTransform,i=this.context;if(t.visible){if(t instanceof PIXI.Sprite){var r=t.texture.frame;r&&(i.globalAlpha=t.worldAlpha,i.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),i.drawImage(t.texture.baseTexture.source,r.x,r.y,r.width,r.height,t.anchor.x*-r.width,t.anchor.y*-r.height,r.width,r.height))}else t instanceof PIXI.Strip?(i.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),this.renderStrip(t)):t instanceof PIXI.TilingSprite?(i.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),this.renderTilingSprite(t)):t instanceof PIXI.CustomRenderable&&t.renderCanvas(this);for(var n=0;t.children.length>n;n++)this.renderDisplayObject(t.children[n]);this.context.setTransform(1,0,0,1,0,0)}},PIXI.CanvasRenderer.prototype.renderStripFlat=function(t){var e=this.context,i=t.verticies;t.uvs;var r=i.length/2;this.count++,e.beginPath();for(var n=1;r-2>n;n++){var o=2*n,s=i[o],a=i[o+2],h=i[o+4],c=i[o+1],u=i[o+3],l=i[o+5];e.moveTo(s,c),e.lineTo(a,u),e.lineTo(h,l)}e.fillStyle="#FF0000",e.fill(),e.closePath()},PIXI.CanvasRenderer.prototype.renderTilingSprite=function(t){var e=this.context;t.__tilePattern||(t.__tilePattern=e.createPattern(t.texture.baseTexture.source,"repeat")),e.beginPath();var i=t.tilePosition,r=t.tileScale;e.scale(r.x,r.y),e.translate(i.x,i.y),e.fillStyle=t.__tilePattern,e.fillRect(-i.x,-i.y,t.width/r.x,t.height/r.y),e.scale(1/r.x,1/r.y),e.translate(-i.x,-i.y),e.closePath()},PIXI.CanvasRenderer.prototype.renderStrip=function(t){var e=this.context,i=t.verticies,r=t.uvs,n=i.length/2;this.count++;for(var o=1;n-2>o;o++){var s=2*o,a=i[s],h=i[s+2],c=i[s+4],u=i[s+1],l=i[s+3],d=i[s+5],p=r[s]*t.texture.width,f=r[s+2]*t.texture.width,I=r[s+4]*t.texture.width,y=r[s+1]*t.texture.height,v=r[s+3]*t.texture.height,g=r[s+5]*t.texture.height;e.save(),e.beginPath(),e.moveTo(a,u),e.lineTo(h,l),e.lineTo(c,d),e.closePath(),e.clip();var b=p*v+y*I+f*g-v*I-y*f-p*g,m=a*v+y*c+h*g-v*c-y*h-a*g,x=p*h+a*I+f*c-h*I-a*f-p*c,P=p*v*c+y*h*I+a*f*g-a*v*I-y*f*c-p*h*g,T=u*v+y*d+l*g-v*d-y*l-u*g,_=p*l+u*I+f*d-l*I-u*f-p*d,X=p*v*d+y*l*I+u*f*g-u*v*I-y*f*d-p*l*g;e.transform(m/b,T/b,x/b,_/b,P/b,X/b),e.drawImage(t.texture.baseTexture.source,0,0),e.restore()}},PIXI.Strip=function(t,e,i){PIXI.DisplayObjectContainer.call(this),this.texture=t,this.blendMode=PIXI.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(r){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}this.width=e,this.height=i,t.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},PIXI.Strip.constructor=PIXI.Strip,PIXI.Strip.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Strip.prototype.setTexture=function(t){this.texture=t,this.width=t.frame.width,this.height=t.frame.height,this.updateFrame=!0},PIXI.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},PIXI.Rope=function(t,e){PIXI.Strip.call(this,t),this.points=e;try{this.verticies=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length)}catch(i){this.verticies=verticies,this.uvs=uvs,this.colors=colors,this.indices=indices}this.refresh()},PIXI.Rope.constructor=PIXI.Rope,PIXI.Rope.prototype=Object.create(PIXI.Strip.prototype),PIXI.Rope.prototype.refresh=function(){var t=this.points;if(!(1>t.length)){var e=this.uvs,i=this.indices,r=this.colors,n=t[0],o=t[0];this.count-=.2,e[0]=0,e[1]=1,e[2]=0,e[3]=1,r[0]=1,r[1]=1,i[0]=0,i[1]=1;for(var s=t.length,a=1;s>a;a++){var o=t[a],h=4*a,c=a/(s-1);a%2?(e[h]=c,e[h+1]=0,e[h+2]=c,e[h+3]=1):(e[h]=c,e[h+1]=0,e[h+2]=c,e[h+3]=1),h=2*a,r[h]=1,r[h+1]=1,h=2*a,i[h]=h,i[h+1]=h+1,n=o}}},PIXI.Rope.prototype.updateTransform=function(){var t=this.points;if(!(1>t.length)){var e,i=this.verticies,r=t[0],n={x:0,y:0},o=t[0];this.count-=.2,i[0]=o.x+n.x,i[1]=o.y+n.y,i[2]=o.x-n.x,i[3]=o.y-n.y;for(var s=t.length,a=1;s>a;a++){var o=t[a],h=4*a;e=t.length-1>a?t[a+1]:o,n.y=-(e.x-r.x),n.x=e.y-r.y;var c=10*(1-a/(s-1));c>1&&(c=1);var u=Math.sqrt(n.x*n.x+n.y*n.y),l=this.texture.height/2;n.x/=u,n.y/=u,n.x*=l,n.y*=l,i[h]=o.x+n.x,i[h+1]=o.y+n.y,i[h+2]=o.x-n.x,i[h+3]=o.y-n.y,r=o}PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)}},PIXI.Rope.prototype.setTexture=function(t){this.texture=t,this.updateFrame=!0},PIXI.TilingSprite=function(t,e,i){PIXI.DisplayObjectContainer.call(this),this.texture=t,this.width=e,this.height=i,this.renderable=!0,this.tileScale=new PIXI.Point(1,1),this.tilePosition=new PIXI.Point(0,0),this.blendMode=PIXI.blendModes.NORMAL},PIXI.TilingSprite.constructor=PIXI.TilingSprite,PIXI.TilingSprite.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.TilingSprite.prototype.setTexture=function(t){this.texture=t,this.updateFrame=!0},PIXI.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0},PIXI.CustomRenderable=function(){PIXI.DisplayObject.call(this)},PIXI.CustomRenderable.constructor=PIXI.CustomRenderable,PIXI.CustomRenderable.prototype=Object.create(PIXI.DisplayObject.prototype),PIXI.CustomRenderable.prototype.renderCanvas=function(){},PIXI.CustomRenderable.prototype.initWebGL=function(){},PIXI.CustomRenderable.prototype.renderWebGL=function(){},PIXI.BaseTextureCache={},PIXI.texturesToUpdate=[],PIXI.texturesToDestroy=[],PIXI.BaseTexture=function(t){if(PIXI.EventTarget.call(this),this.width=100,this.height=100,this.source=t,t){if(this.source instanceof Image)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,PIXI.texturesToUpdate.push(this);else{var e=this;this.source.onload=function(){e.hasLoaded=!0,e.width=e.source.width,e.height=e.source.height,PIXI.texturesToUpdate.push(e),e.dispatchEvent({type:"loaded",content:e})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,PIXI.texturesToUpdate.push(this);this._powerOf2=!1}},PIXI.BaseTexture.constructor=PIXI.BaseTexture,PIXI.BaseTexture.prototype.destroy=function(){this.source instanceof Image&&(this.source.src=null),this.source=null,PIXI.texturesToDestroy.push(this)},PIXI.BaseTexture.fromImage=function(t,e){var i=PIXI.BaseTextureCache[t];if(!i){var r=new Image;e&&(r.crossOrigin=""),r.src=t,i=new PIXI.BaseTexture(r),PIXI.BaseTextureCache[t]=i}return i},PIXI.TextureCache={},PIXI.FrameCache={},PIXI.Texture=function(t,e){if(PIXI.EventTarget.call(this),e||(this.noFrame=!0,e=new PIXI.Rectangle(0,0,1,1)),this.trim=new PIXI.Point,t instanceof PIXI.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.scope=this,t.hasLoaded)this.noFrame&&(e=new PIXI.Rectangle(0,0,t.width,t.height)),this.setFrame(e);else{var i=this;t.addEventListener("loaded",function(){i.onBaseTextureLoaded()})}},PIXI.Texture.constructor=PIXI.Texture,PIXI.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new PIXI.Rectangle(0,0,t.width,t.height)),this.noFrame=!1,this.width=this.frame.width,this.height=this.frame.height,this.scope.dispatchEvent({type:"update",content:this})},PIXI.Texture.prototype.destroy=function(t){t&&this.baseTexture.destroy()},PIXI.Texture.prototype.setFrame=function(t){if(this.frame=t,this.width=t.width,this.height=t.height,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0,PIXI.Texture.frameUpdates.push(this)},PIXI.Texture.fromImage=function(t,e){var i=PIXI.TextureCache[t];return i||(i=new PIXI.Texture(PIXI.BaseTexture.fromImage(t,e)),PIXI.TextureCache[t]=i),i},PIXI.Texture.fromFrame=function(t){var e=PIXI.TextureCache[t];if(!e)throw Error("The frameId '"+t+"' does not exist in the texture cache "+this);return e},PIXI.Texture.fromCanvas=function(t){var e=new PIXI.BaseTexture(t);return new PIXI.Texture(e)},PIXI.Texture.addTextureToCache=function(t,e){PIXI.TextureCache[e]=t},PIXI.Texture.removeTextureFromCache=function(t){var e=PIXI.TextureCache[t];return PIXI.TextureCache[t]=null,e},PIXI.Texture.frameUpdates=[],PIXI.RenderTexture=function(t,e){PIXI.EventTarget.call(this),this.width=t||100,this.height=e||100,this.indetityMatrix=PIXI.mat3.create(),this.frame=new PIXI.Rectangle(0,0,this.width,this.height),PIXI.gl?this.initWebGL():this.initCanvas()},PIXI.RenderTexture.constructor=PIXI.RenderTexture,PIXI.RenderTexture.prototype=Object.create(PIXI.Texture.prototype),PIXI.RenderTexture.prototype.initWebGL=function(){var t=PIXI.gl;this.glFramebuffer=t.createFramebuffer(),t.bindFramebuffer(t.FRAMEBUFFER,this.glFramebuffer),this.glFramebuffer.width=this.width,this.glFramebuffer.height=this.height,this.baseTexture=new PIXI.BaseTexture,this.baseTexture.width=this.width,this.baseTexture.height=this.height,this.baseTexture._glTexture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this.baseTexture._glTexture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,this.width,this.height,0,t.RGBA,t.UNSIGNED_BYTE,null),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),this.baseTexture.isRender=!0,t.bindFramebuffer(t.FRAMEBUFFER,this.glFramebuffer),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,this.baseTexture._glTexture,0),this.projectionMatrix=PIXI.mat4.create(),this.projectionMatrix[5]=2/this.height,this.projectionMatrix[13]=-1,this.projectionMatrix[0]=2/this.width,this.projectionMatrix[12]=-1,this.render=this.renderWebGL},PIXI.RenderTexture.prototype.initCanvas=function(){this.renderer=new PIXI.CanvasRenderer(this.width,this.height,null,0),this.baseTexture=new PIXI.BaseTexture(this.renderer.view),this.frame=new PIXI.Rectangle(0,0,this.width,this.height),this.render=this.renderCanvas},PIXI.RenderTexture.prototype.renderWebGL=function(t,e){var i=PIXI.gl;i.colorMask(!0,!0,!0,!0),i.viewport(0,0,this.width,this.height),i.bindFramebuffer(i.FRAMEBUFFER,this.glFramebuffer),e&&(i.clearColor(0,0,0,0),i.clear(i.COLOR_BUFFER_BIT));var r=t.children;t.worldTransform=PIXI.mat3.create();for(var n=0,o=r.length;o>n;n++)r[n].updateTransform();var s=t.__renderGroup;s?t==s.root?s.render(this.projectionMatrix):s.renderSpecific(t,this.projectionMatrix):(this.renderGroup||(this.renderGroup=new PIXI.WebGLRenderGroup(i)),this.renderGroup.setRenderable(t),this.renderGroup.render(this.projectionMatrix))},PIXI.RenderTexture.prototype.renderCanvas=function(t,e){var i=t.children;t.worldTransform=PIXI.mat3.create();for(var r=0,n=i.length;n>r;r++)i[r].updateTransform();e&&this.renderer.context.clearRect(0,0,this.width,this.height),this.renderer.renderDisplayObject(t),PIXI.texturesToUpdate.push(this.baseTexture)},PIXI.AssetLoader=function(t){PIXI.EventTarget.call(this),this.assetURLs=t,this.crossorigin=!1,this.loadersByType={jpg:PIXI.ImageLoader,jpeg:PIXI.ImageLoader,png:PIXI.ImageLoader,gif:PIXI.ImageLoader,json:PIXI.SpriteSheetLoader,xml:PIXI.BitmapFontLoader,fnt:PIXI.BitmapFontLoader}},PIXI.AssetLoader.constructor=PIXI.AssetLoader,PIXI.AssetLoader.prototype.load=function(){var t=this;this.loadCount=this.assetURLs.length;for(var e=0;this.assetURLs.length>e;e++){var i=this.assetURLs[e],r=i.split(".").pop().toLowerCase(),n=this.loadersByType[r];if(!n)throw Error(r+" is an unsupported file type");var o=new n(i,this.crossorigin);o.addEventListener("loaded",function(){t.onAssetLoaded()}),o.load()}},PIXI.AssetLoader.prototype.onAssetLoaded=function(){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this}),this.onProgress&&this.onProgress(),0==this.loadCount&&(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())},PIXI.SpriteSheetLoader=function(t,e){PIXI.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.frames={},this.crossorigin=e},PIXI.SpriteSheetLoader.constructor=PIXI.SpriteSheetLoader,PIXI.SpriteSheetLoader.prototype.load=function(){this.ajaxRequest=new AjaxRequest;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},PIXI.SpriteSheetLoader.prototype.onJSONLoaded=function(){if(4==this.ajaxRequest.readyState&&(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http"))){var jsonData=eval("("+this.ajaxRequest.responseText+")"),textureUrl=this.baseUrl+jsonData.meta.image,image=new PIXI.ImageLoader(textureUrl,this.crossorigin);this.texture=image.texture.baseTexture;var scope=this;image.addEventListener("loaded",function(){scope.onLoaded()});var frameData=jsonData.frames;for(var i in frameData){var rect=frameData[i].frame;rect&&(PIXI.TextureCache[i]=new PIXI.Texture(this.texture,{x:rect.x,y:rect.y,width:rect.w,height:rect.h}),frameData[i].trimmed&&(PIXI.TextureCache[i].realSize=frameData[i].spriteSourceSize,PIXI.TextureCache[i].trim.x=0))}image.load()}},PIXI.SpriteSheetLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},PIXI.ImageLoader=function(t,e){PIXI.EventTarget.call(this),this.texture=PIXI.Texture.fromImage(t,e)},PIXI.ImageLoader.constructor=PIXI.ImageLoader,PIXI.ImageLoader.prototype.load=function(){if(this.texture.baseTexture.hasLoaded)this.onLoaded();else{var t=this;this.texture.baseTexture.addEventListener("loaded",function(){t.onLoaded()})}},PIXI.ImageLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},PIXI.BitmapFontLoader=function(t,e){PIXI.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture=null,this.crossorigin=e},PIXI.BitmapFontLoader.constructor=PIXI.BitmapFontLoader,PIXI.BitmapFontLoader.prototype.load=function(){this.ajaxRequest=new XMLHttpRequest;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onXMLLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/xml"),this.ajaxRequest.send(null)},PIXI.BitmapFontLoader.prototype.onXMLLoaded=function(){if(4==this.ajaxRequest.readyState&&(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http"))){var t=this.baseUrl+this.ajaxRequest.responseXML.getElementsByTagName("page")[0].attributes.getNamedItem("file").nodeValue,e=new PIXI.ImageLoader(t,this.crossorigin);this.texture=e.texture.baseTexture;var i={},r=this.ajaxRequest.responseXML.getElementsByTagName("info")[0],n=this.ajaxRequest.responseXML.getElementsByTagName("common")[0];i.font=r.attributes.getNamedItem("face").nodeValue,i.size=parseInt(r.attributes.getNamedItem("size").nodeValue,10),i.lineHeight=parseInt(n.attributes.getNamedItem("lineHeight").nodeValue,10),i.chars={};for(var o=this.ajaxRequest.responseXML.getElementsByTagName("char"),s=0;o.length>s;s++){var a=parseInt(o[s].attributes.getNamedItem("id").nodeValue,10),h={x:parseInt(o[s].attributes.getNamedItem("x").nodeValue,10),y:parseInt(o[s].attributes.getNamedItem("y").nodeValue,10),width:parseInt(o[s].attributes.getNamedItem("width").nodeValue,10),height:parseInt(o[s].attributes.getNamedItem("height").nodeValue,10)};PIXI.TextureCache[a]=new PIXI.Texture(this.texture,h),i.chars[a]={xOffset:parseInt(o[s].attributes.getNamedItem("xoffset").nodeValue,10),yOffset:parseInt(o[s].attributes.getNamedItem("yoffset").nodeValue,10),xAdvance:parseInt(o[s].attributes.getNamedItem("xadvance").nodeValue,10),kerning:{}}}var c=this.ajaxRequest.responseXML.getElementsByTagName("kerning");for(s=0;c.length>s;s++){var u=parseInt(c[s].attributes.getNamedItem("first").nodeValue,10),l=parseInt(c[s].attributes.getNamedItem("second").nodeValue,10),d=parseInt(c[s].attributes.getNamedItem("amount").nodeValue,10);i.chars[l].kerning[u]=d}PIXI.BitmapText.fonts[i.font]=i;var p=this;e.addEventListener("loaded",function(){p.onLoaded()}),e.load()}},PIXI.BitmapFontLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=PIXI),exports.PIXI=PIXI):root.PIXI=PIXI}.call(this),function(){var t=this,e=e||{};e.Cache={},e.Layers=function(){PIXI.DisplayObjectContainer.call(this),this.blockedNames=Object.keys(this),this._defaultVisibility=!0,this.sort=!1;for(var t in arguments){var e=arguments[t];if("string"==typeof e)this.addLayer(e);else if(e instanceof Object)for(var i in e)this[i]=e[i],this.addChild(e[i])}},e.Layers.constructor=e.Layers,e.Layers.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),e.Layers.prototype.addLayer=function(t){return this.addLayerAt(t,this.children.length)},e.Layers.prototype.addLayerAt=function(t,e){if(t in this)throw Error(t+" Suplied name already used by "+this[t]);var i=new PIXI.DisplayObjectContainer;return i.layername=t,i.visible=this._defaultVisibility,this.addChildAt(i,e),this[t]=i,i},e.Layers.prototype.swapLayers=function(t,e){var i=this[t],r=this[e];this.swapChildren(i,r)},e.Layers.prototype.getLayer=function(t){return this[t]||this.addLayer(t),this[t]},e.Layers.prototype.getLayerAt=function(t){return this.getChildAt(t)},e.Layers.prototype.removeLayer=function(t){t in this&&!(t in this.blockedNames)&&(PIXI.DisplayObjectContainer.prototype.removeChild.call(this,this[t]),delete this[t])},e.Keyboard=function(){var t=this;this.pressed={},this.callbacks={},Object.keys(this.Codes).forEach(function(i){t[i]={press:function(e){return t.callbacks[i]=e,t}},t[i].press(function(){}),Object.defineProperty(t.pressed,e.Keyboard.prototype.Codes[i],{configurable:!0,get:function(){return{press:function(){t.callbacks[i]&&t.callbacks[i](i)}}}})}),document.addEventListener("keydown",this.onKeyDown.bind(this),!1),document.addEventListener("keyup",this.onKeyUp.bind(this),!1)},e.Keyboard.constructor=e.Keyboard,e.Keyboard.prototype.runCallbacks=function(){var t=this;Object.keys(e.Key.pressed).forEach(function(e){t.pressed[e].press()})},e.Keyboard.prototype.onKeyDown=function(t,e){return this.modifyKey(t,e||t.keyCode||t.which,!0)},e.Keyboard.prototype.onKeyUp=function(t,e){return this.modifyKey(t,e||t.keyCode||t.which,!1)},e.Keyboard.prototype.modifyKey=function(t,e,i){return e&&Object.defineProperty(this.pressed,e,{enumerable:i}),!0},e.Keyboard.prototype.Codes={Backspace:8,Tab:9,Enter:13,Shift:16,Ctrl:17,Alt:18,Pause:19,Capslock:20,Esc:27,Spacebar:32,Pageup:33,Pagedown:34,End:35,Home:36,Leftarrow:37,Uparrow:38,Rightarrow:39,Downarrow:40,Insert:45,Delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,"0numpad":96,"1numpad":97,"2numpad":98,"3numpad":99,"4numpad":100,"5numpad":101,"6numpad":102,"7numpad":103,"8numpad":104,"9numpad":105,Multiply:106,Plus:107,Minut:109,Dot:110,Slash1:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,equal:187,Coma:188,Slash:191,Backslash:220},e.Key=new e.Keyboard,e.Mouse=function(t){var i=this;t=t||document,this.offset=e.Utils.getOffset(t),this.position=new PIXI.Point(0,0),t.addEventListener("mousemove",this.onMouseMove.bind(this),!1),this.callbacks={},this.on={},Object.keys(e.Mouse.prototype.Events).forEach(function(r){i.on[r]=function(t){i.callbacks[i.Events[r]]=t};var n=e.Mouse.prototype.Events[r];"mousemove"!==n&&"mousewheel"!==n&&t.addEventListener(n,i.onMouse.bind(i),!1)})},e.Mouse.constructor=e.Mouse,e.Mouse.prototype.onMouse=function(t){return this.updateCoords(t),t.type&&this.callbacks[t.type]&&this.callbacks[t.type](t),!0},e.Mouse.prototype.onMouseMove=function(t){return this.updateCoords(t),this.callbacks.mousemove&&this.callbacks.mousemove(t),!0},e.Mouse.prototype.updateCoords=function(t){this.position.x=t.pageX-this.offset.left,this.position.y=t.pageY-this.offset.top},e.Mouse.prototype.Events={wheel:"mousewheel",move:"mousemove",down:"mousedown",up:"mouseup",click:"click",dbclick:"dblclick",rclick:"contextmenu",contextmenu:"contextmenu"},e.Camera=function(t,e){PIXI.DisplayObjectContainer.call(this),this.width=t,this.height=e,this.halfWidth=0|t/2,this.halfHeight=0|e/2;var i=new PIXI.Rectangle(0,0,0,0);Object.defineProperty(this,"bounds",{get:function(){return i},set:function(t){if(!(t instanceof PIXI.Rectangle))throw Error(t+" bounds must be instance of PIXI.Rectangle");i=t.clone(),i.maxX=t.x+t.width-this.width,i.minX=t.x,i.maxY=t.y+t.height-this.height,i.minY=t.y}}),this.freeze=!1,this._linkedObject=null},e.Camera.constructor=e.Camera,e.Camera.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),e.Camera.prototype.on=function(t){if(!(t instanceof PIXI.DisplayObjectContainer))throw Error(t+" object should be instance of DisplayObjectContainer");if(t instanceof PIXI.Stage){for(;t.children[0];)this.addChild(t.children[0]);return t.addChild(this),this}this.parent&&this.off();var e=t.parent;if(!e)throw Error("Can't bind Camera on DisplayObjectContainer without parent");var i=e.children.indexOf(t);return e.removeChild(t),this.addChild(t),t=this,e.addChildAt(t,i),this},e.Camera.prototype.off=function(){var t=this.parent;if(t){var e=t.children.indexOf(this);for(t.removeChild(this);this.children[0];)t.addChildAt(this.children[0],e++);return this}throw Error("Can't remove Camera without Camera.parent defined")},e.Camera.prototype.follow=function(t){return this._linkedObject=t,this},e.Camera.prototype.updateTransform=function(){if(this._linkedObject&&!this.freeze){var t=this._linkedObject.position.clone();t.x-=this.halfWidth,t.y-=this.halfHeight,t.x=Math.min(this.bounds.maxX,Math.max(this.bounds.minX,t.x)),t.y=Math.min(this.bounds.maxY,Math.max(this.bounds.minY,t.y)),this.position=new PIXI.Point(-t.x,-t.y)}PIXI.Sprite.prototype.updateTransform.call(this)},e.Network=function(t){this.config=t},e.Network.constructor=e.Network,e.Network.prototype.connect=function(t,e){this.socket=new WebSocket("ws://"+t+(e?":"+e:"")),this.onopen(this.onopen_callback),this.onclose(this.onclose_callback),this.onerror(this.onerror_callback),this.onmessage(this.onmessage_callback)},e.Network.prototype.decode=function(t,e){if("string"==typeof t.data)e(JSON.parse(t.data));else{var i=new FileReader;i.readAsArrayBuffer(t.data),i.onloadend=function(){var t=msgpack.decode(this.result);e(t)}}},e.Network.prototype.onmessage=function(t){var e=this;this.onmessage_callback=t,this.socket&&(this.socket.onmessage=function(i){e.decode(i,t)})},e.Network.prototype.onopen=function(t){this.onopen_callback=t,this.socket&&(this.socket.onopen=t)},e.Network.prototype.onerror=function(t){this.onerror_callback=t,this.socket&&(this.socket.onerror=t)},e.Network.prototype.onclose=function(t){this.onclose_callback=t,this.socket&&(this.socket.onclose=t)},e.Network.prototype.send=function(t){this.socket&&this.socket.send(this.config.binary?msgpack.encode(t):JSON.stringify(t))},e.Network.prototype.close=function(){this.socket&&this.socket.close()},e.SimpleGrid=function(t,i){e.Layers.call(this),this._defaultVisibility=!1,this._width=t||10,this._height=i||10,this.visibleCells={}},e.SimpleGrid.constructor=e.SimpleGrid,e.SimpleGrid.prototype=Object.create(e.Layers.prototype),e.SimpleGrid.prototype.getCellСoordinates=function(t){return{x:t.position.x>>this._width,y:t.position.y>>this._height}},e.SimpleGrid.prototype.getCellName=function(t){var e=this.getCellСoordinates(t);return e.x+"_"+e.y},e.SimpleGrid.prototype.addChild=function(t){this.getLayer(this.getCellName(t)).addChild(t)},e.SimpleGrid.prototype.getSurroundCells=function(t,e){e=e||new PIXI.Rectangle(0,0,800,600);for(var i=this.getCellСoordinates(t),r=[],n=i.x-(e.width>>this._width+1);i.x+(2*e.width>>this._width+1)>n;n++)for(var o=i.y-(e.height>>this._height+1);i.y+(2*e.height>>this._height+1)>o;o++)r.push(this[n+"_"+o]);return r},e.SimpleGrid.prototype.setVisibleAround=function(t,e,i){var r=this;i=i||!0;var n=this.getSurroundCells(t,e);n.forEach(function(t,e){t&&(r.visibleCells[e]=i?t:void 0,t.visible=i)})},e.Stats=function(){PIXI.DisplayObjectContainer.call(this),this._fpsCounter=new Stats,this._fpsCounter.domElement.style.position="absolute",this._fpsCounter.domElement.style.left=e.Stats.left+"px",this._fpsCounter.domElement.style.top="0px",this._fpsCounter.domElement.style.zIndex="10000",document.body.appendChild(this._fpsCounter.domElement),e.Stats.left+=80},e.Stats.left=0,e.Stats.constructor=e.Stats,e.Stats.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),e.Stats.on=function(t){t.addChild(new e.Stats)},e.Stats.prototype.updateTransform=function(){this._fpsCounter.update(),PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)},e.MovieClipManager=function(){PIXI.DisplayObjectContainer.call(this),this._animations={},this._current=void 0;for(var t in arguments){var e=arguments[t];this.add(e.name,e.clip)}},e.MovieClipManager.constructor=e.MovieClipManager,e.MovieClipManager.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),e.MovieClipManager.prototype.get=function(t){return this._animations[t]},e.MovieClipManager.prototype.set=function(t){return this._current&&(this._current.stop(),this._current.visible=!1),this._current=this._animations[t],this._current&&(this._current.visible=!0),this},e.MovieClipManager.prototype.play=function(t){return t&&this.set(t),this._current&&this._current.play(),this},e.MovieClipManager.prototype.gotoAndStop=function(t){return this._current.gotoAndStop(t),this},e.MovieClipManager.prototype.gotoAndPlay=function(t){return this._current.gotoAndPlay(t),this},e.MovieClipManager.prototype.animationSpeed=function(t){return this._current.animationSpeed=t,this},e.MovieClipManager.prototype.loop=function(t){return this._current.loop=t,this},e.MovieClipManager.prototype.onComplete=function(t){return this._current.onComplete=t,this},e.MovieClipManager.prototype.stop=function(){return this._current&&this._current.stop(),this},e.MovieClipManager.prototype.add=function(t,e,i){return this._animations[t]=e,e.animationSpeed=i||e.animationSpeed,this.addChild(e),e.visible=!1,this},e.MovieClipManager.prototype.remove=function(t){this._animations[t]===this._current&&(this._current.visible=!1,this._current=void 0),delete this._animations[t]};var i=function(){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new window.XMLHttpRequest:!1;for(var e=0;t.length>e;e++)try{return new window.ActiveXObject(t[e])}catch(i){}};e.JsonLoader=function(t,e){PIXI.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.json=null,this.crossorigin=e},e.JsonLoader.constructor=e.JsonLoader,e.JsonLoader.prototype.load=function(){this.ajaxRequest=new i;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onJSONLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},e.JsonLoader.prototype.onJSONLoaded=function(){4===this.ajaxRequest.readyState&&(200===this.ajaxRequest.status||-1===window.location.href.indexOf("http"))&&(this.json=JSON.parse(this.ajaxRequest.responseText),e.Cache[this.url]=this.json,this.onLoaded())},e.JsonLoader.prototype.onLoaded=function(){this.dispatchEvent({type:"loaded",content:this})},e.Loader=function(t){PIXI.AssetLoader.call(this,t),this.loadersByType.json=e.JsonLoader},e.Loader.constructor=e.Loader,e.Loader.prototype=Object.create(PIXI.AssetLoader),e.Loader.prototype.load=function(t){var e=this.assetURLs;this.assetURLs=t||this.assetURLs,PIXI.AssetLoader.prototype.load.call(this),this.assetURLs=e},e.TiledMap=function(t,i){e.Layers.call(this);var r=this;this.config=i,this.tilecache={};var n=new e.JsonLoader(t,!1);n.addEventListener("loaded",function(t){r.onTiledMapJsonLoaded(t)}),n.load()},e.TiledMap.constructor=e.TiledMap,e.TiledMap.prototype=Object.create(e.Layers.prototype),e.TiledMap.prototype.onTiledMapJsonLoaded=function(t){var e=t.content.json;this.scale={x:parseInt(e.properties.scale,10)||1,y:parseInt(e.properties.scale,10)||1},this.tilesize={width:e.tilewidth,height:e.tileheight},this.tilesets=[],this.tilecache={};for(var i=0,r=e.tilesets.length;r>i;++i){var n=e.tilesets[i];n.lastgid=n.firstgid+n.imagewidth/n.tilewidth*(n.imageheight/n.tileheight),n.baseTexture=PIXI.Texture.fromImage(n.image).baseTexture,this.tilesets.push(n)}this.version=e.version;for(var o=0,s=e.layers.length;s>o;++o)"tilelayer"===e.layers[o].type&&this.createTileLayer(e.layers[o]),"objectgroup"===e.layers[o].type&&this.addLayer(e.layers[o].name)},e.TiledMap.prototype.createTileLayer=function(t){var e=this.addLayer(t.name);e.alpha=t.opacity,e.width=t.width,e.height=t.height,e.visible=t.visible,e.position.x=0|t.x*this.tilesize.width,e.position.y=0|t.y*this.tilesize.height,e.type=t.type;for(var i in t.data){var r=t.data[i];if(0!==r){var n=this.getTileSet(r),o=this.getTileTexture(r,n),s=new PIXI.Sprite(o);s.position=new PIXI.Point((0|i%e.width)*this.tilesize.width,(0|i/e.width)*this.tilesize.height),e.addChild(s)}}},e.TiledMap.prototype.getTileSet=function(t){for(var e in this.tilesets){var i=this.tilesets[e];if(t>=i.firstgid&&i.lastgid>t)return i}throw Error("Tileset for index "+t+" not found!")},e.TiledMap.prototype.getTileTexture=function(t,e){if(this.tilecache[t])return this.tilecache[t];var i=t-e.firstgid,r=new PIXI.Rectangle(0|i*e.tilewidth%e.imagewidth,(0|i*e.tilewidth/e.imagewidth)*e.tileheight,e.tilewidth,e.tileheight);return this.tilecache[t]=new PIXI.Texture(e.baseTexture,r),this.tilecache[t]},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.LINK=e):t.LINK=e}.call(this);