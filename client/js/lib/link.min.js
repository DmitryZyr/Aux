/**
 * @license
 * Link.JS Game Engine - v0.0.1
 * Copyright (c) 2013, Vsevolod Strukchinsky
 * hhttps://github.com/floatdrop/link.js
 *
 * Compiled: 2013-05-10
 *
 * Link.JS Game Engine is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license.php
 */
function HEXtoRGB(t){return[(255&t>>16)/255,(255&t>>8)/255,(255&t)/255]}function determineMatrixArrayType(){return PIXI.Matrix="undefined"!=typeof Float32Array?Float32Array:Array,PIXI.Matrix}this.msgpack||function(t){function e(t,e){l=0;var r=i([],t,0);return l?!1:e?o(r):r}function r(t){return c="string"==typeof t?s(t):t,u=-1,n()}function i(t,e,r){var n,o,s,a,h,c,u,d,I,v;if(null==e)t.push(192);else if(e===!1)t.push(194);else if(e===!0)t.push(195);else switch(typeof e){case"number":e!==e?t.push(203,255,255,255,255,255,255,255,255):1/0===e?t.push(203,127,240,0,0,0,0,0,0):Math.floor(e)===e?0>e?e>=-32?t.push(224+e+32):e>-128?t.push(208,e+256):e>-32768?(e+=65536,t.push(209,e>>8,255&e)):e>-2147483648?(e+=4294967296,t.push(210,e>>>24,255&e>>16,255&e>>8,255&e)):(c=Math.floor(e/4294967296),u=4294967295&e,t.push(211,255&c>>24,255&c>>16,255&c>>8,255&c,255&u>>24,255&u>>16,255&u>>8,255&u)):128>e?t.push(e):256>e?t.push(204,e):65536>e?t.push(205,e>>8,255&e):4294967296>e?t.push(206,e>>>24,255&e>>16,255&e>>8,255&e):(c=Math.floor(e/4294967296),u=4294967295&e,t.push(207,255&c>>24,255&c>>16,255&c>>8,255&c,255&u>>24,255&u>>16,255&u>>8,255&u)):(d=0>e,d&&(e*=-1),I=0|Math.log(e)/.6931471805599453+1023,v=e*Math.pow(2,1075-I),u=4294967295&v,d&&(I|=2048),c=1048575&v/4294967296|I<<20,t.push(203,255&c>>24,255&c>>16,255&c>>8,255&c,255&u>>24,255&u>>16,255&u>>8,255&u));break;case"string":for(s=e.length,h=t.length,t.push(0),o=0;s>o;++o)a=e.charCodeAt(o),128>a?t.push(127&a):2048>a?t.push(192|31&a>>>6,128|63&a):65536>a&&t.push(224|15&a>>>12,128|63&a>>>6,128|63&a);n=t.length-h-1,32>n?t[h]=160+n:65536>n?t.splice(h,1,218,n>>8,255&n):4294967296>n&&t.splice(h,1,219,n>>>24,255&n>>16,255&n>>8,255&n);break;default:if(++r>=f)return l=1,t=[];if(p(e))for(n=e.length,16>n?t.push(144+n):65536>n?t.push(220,n>>8,255&n):4294967296>n&&t.push(221,n>>>24,255&n>>16,255&n>>8,255&n),o=0;n>o;++o)i(t,e[o],r);else{h=t.length,t.push(0),n=0;for(o in e)++n,i(t,o,r),i(t,e[o],r);16>n?t[h]=128+n:65536>n?t.splice(h,1,222,n>>8,255&n):4294967296>n&&t.splice(h,1,223,n>>>24,255&n>>16,255&n>>8,255&n)}}return t}function n(){var t,e,r,i,s,a,h,l,p,f=0,I=c,v=I[++u];if(v>=224)return v-256;if(192>v){if(128>v)return v;144>v?(f=v-128,v=128):160>v?(f=v-144,v=144):(f=v-160,v=160)}switch(v){case 192:return null;case 194:return!1;case 195:return!0;case 202:return f=16777216*I[++u]+(I[++u]<<16)+(I[++u]<<8)+I[++u],s=2147483648&f,a=255&f>>23,h=8388607&f,f&&2147483648!==f?255===a?h?0/0:1/0:(s?-1:1)*(8388608|h)*Math.pow(2,a-127-23):0;case 203:return f=16777216*I[++u]+(I[++u]<<16)+(I[++u]<<8)+I[++u],s=2147483648&f,a=2047&f>>20,h=1048575&f,f&&2147483648!==f?2047===a?(u+=4,h?0/0:1/0):(f=16777216*I[++u]+(I[++u]<<16)+(I[++u]<<8)+I[++u],(s?-1:1)*((1048576|h)*Math.pow(2,a-1023-20)+f*Math.pow(2,a-1023-52))):(u+=4,0);case 207:return f=16777216*I[++u]+(I[++u]<<16)+(I[++u]<<8)+I[++u],4294967296*f+16777216*I[++u]+(I[++u]<<16)+(I[++u]<<8)+I[++u];case 206:f+=16777216*I[++u]+(I[++u]<<16);case 205:f+=I[++u]<<8;case 204:return f+I[++u];case 211:return f=I[++u],128&f?-1*(72057594037927940*(255^f)+281474976710656*(255^I[++u])+1099511627776*(255^I[++u])+4294967296*(255^I[++u])+16777216*(255^I[++u])+65536*(255^I[++u])+256*(255^I[++u])+(255^I[++u])+1):72057594037927940*f+281474976710656*I[++u]+1099511627776*I[++u]+4294967296*I[++u]+16777216*I[++u]+65536*I[++u]+256*I[++u]+I[++u];case 210:return f=16777216*I[++u]+(I[++u]<<16)+(I[++u]<<8)+I[++u],2147483648>f?f:f-4294967296;case 209:return f=(I[++u]<<8)+I[++u],32768>f?f:f-65536;case 208:return f=I[++u],128>f?f:f-256;case 219:f+=16777216*I[++u]+(I[++u]<<16);case 218:f+=(I[++u]<<8)+I[++u];case 160:for(l=[],e=u,r=e+f;r>e;)i=I[++e],l.push(128>i?i:224>i?(31&i)<<6|63&I[++e]:(15&i)<<12|(63&I[++e])<<6|63&I[++e]);return u=e,10240>l.length?d.apply(null,l):o(l);case 223:f+=16777216*I[++u]+(I[++u]<<16);case 222:f+=(I[++u]<<8)+I[++u];case 128:for(p={};f--;){for(t=I[++u]-160,l=[],e=u,r=e+t;r>e;)i=I[++e],l.push(128>i?i:224>i?(31&i)<<6|63&I[++e]:(15&i)<<12|(63&I[++e])<<6|63&I[++e]);u=e,p[d.apply(null,l)]=n()}return p;case 221:f+=16777216*I[++u]+(I[++u]<<16);case 220:f+=(I[++u]<<8)+I[++u];case 144:for(l=[];f--;)l.push(n());return l}}function o(t){try{return d.apply(this,t)}catch(e){}for(var r=[],i=0,n=t.length,o=h;n>i;++i)r[i]=o[t[i]];return r.join("")}function s(t){var e,r,i=[],n=a,o=t.split(""),s=-1;for(r=o.length,e=r%8;e--;)++s,i[s]=n[o[s]];for(e=r>>3;e--;)i.push(n[o[++s]],n[o[++s]],n[o[++s]],n[o[++s]],n[o[++s]],n[o[++s]],n[o[++s]],n[o[++s]]);return i}t.msgpack={pack:e,unpack:r};var a={},h={},c=[],u=0,l=0,p=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},d=String.fromCharCode,f=512;(function(){for(var t,e=0;256>e;++e)t=d(e),a[t]=e,h[e]=t;for(e=128;256>e;++e)a[d(63232+e)]=e})()}(this),function(t){"function"==typeof define?define(t):"function"==typeof YUI?YUI.add("es5",t):t()}(function(){function t(){}function e(t){return t=+t,t!==t?t=0:0!==t&&t!==1/0&&t!==-(1/0)&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t}function r(t){var e=typeof t;return null===t||"undefined"===e||"boolean"===e||"number"===e||"string"===e}Function.prototype.bind||(Function.prototype.bind=function(e){var r=this;if("function"!=typeof r)throw new TypeError("Function.prototype.bind called on incompatible "+r);var i=o.call(arguments,1),n=function(){if(this instanceof n){var t=r.apply(this,i.concat(o.call(arguments)));return Object(t)===t?t:this}return r.apply(e,i.concat(o.call(arguments)))};return r.prototype&&(t.prototype=r.prototype,n.prototype=new t,t.prototype=null),n});var i=Function.prototype.call,n=Object.prototype,o=Array.prototype.slice,s=i.bind(n.toString),a=i.bind(n.hasOwnProperty);if(a(n,"__defineGetter__")&&(i.bind(n.__defineGetter__),i.bind(n.__defineSetter__),i.bind(n.__lookupGetter__),i.bind(n.__lookupSetter__)),2!=[1,2].splice(0).length){var h=Array.prototype.splice;Array.prototype.splice=function(t,e){return arguments.length?h.apply(this,[void 0===t?0:t,void 0===e?this.length-t:e].concat(o.call(arguments,2))):[]}}if(1!=[].unshift(0)){var c=Array.prototype.unshift;Array.prototype.unshift=function(){return c.apply(this,arguments),this.length}}Array.isArray||(Array.isArray=function(t){return"[object Array]"==s(t)});var i=Object("a"),u="a"!=i[0]||!(0 in i);if(Array.prototype.forEach||(Array.prototype.forEach=function(t,e){var r=w(this),i=u&&"[object String]"==s(this)?this.split(""):r,n=-1,o=i.length>>>0;if("[object Function]"!=s(t))throw new TypeError;for(;o>++n;)n in i&&t.call(e,i[n],n,r)}),Array.prototype.map||(Array.prototype.map=function(t,e){var r=w(this),i=u&&"[object String]"==s(this)?this.split(""):r,n=i.length>>>0,o=Array(n);if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");for(var a=0;n>a;a++)a in i&&(o[a]=t.call(e,i[a],a,r));return o}),Array.prototype.filter||(Array.prototype.filter=function(t,e){var r,i=w(this),n=u&&"[object String]"==s(this)?this.split(""):i,o=n.length>>>0,a=[];if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");for(var h=0;o>h;h++)h in n&&(r=n[h],t.call(e,r,h,i)&&a.push(r));return a}),Array.prototype.every||(Array.prototype.every=function(t,e){var r=w(this),i=u&&"[object String]"==s(this)?this.split(""):r,n=i.length>>>0;if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");for(var o=0;n>o;o++)if(o in i&&!t.call(e,i[o],o,r))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(t,e){var r=w(this),i=u&&"[object String]"==s(this)?this.split(""):r,n=i.length>>>0;if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");for(var o=0;n>o;o++)if(o in i&&t.call(e,i[o],o,r))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(t){var e=w(this),r=u&&"[object String]"==s(this)?this.split(""):e,i=r.length>>>0;if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");if(!i&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var n,o=0;if(arguments.length>=2)n=arguments[1];else for(;;){if(o in r){n=r[o++];break}if(++o>=i)throw new TypeError("reduce of empty array with no initial value")}for(;i>o;o++)o in r&&(n=t.call(void 0,n,r[o],o,e));return n}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(t){var e=w(this),r=u&&"[object String]"==s(this)?this.split(""):e,i=r.length>>>0;if("[object Function]"!=s(t))throw new TypeError(t+" is not a function");if(!i&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var n,i=i-1;if(arguments.length>=2)n=arguments[1];else for(;;){if(i in r){n=r[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(n=t.call(void 0,n,r[i],i,e));while(i--);return n}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(t){var r=u&&"[object String]"==s(this)?this.split(""):w(this),i=r.length>>>0;if(!i)return-1;var n=0;for(arguments.length>1&&(n=e(arguments[1])),n=n>=0?n:Math.max(0,i+n);i>n;n++)if(n in r&&r[n]===t)return n;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(t){var r=u&&"[object String]"==s(this)?this.split(""):w(this),i=r.length>>>0;if(!i)return-1;var n=i-1;for(arguments.length>1&&(n=Math.min(n,e(arguments[1]))),n=n>=0?n:i-Math.abs(n);n>=0;n--)if(n in r&&t===r[n])return n;return-1}),!Object.keys){var l,p=!0,d="toString toLocaleString valueOf hasOwnProperty isPrototypeOf propertyIsEnumerable constructor".split(" "),f=d.length;for(l in{toString:null})p=!1;Object.keys=function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.keys called on a non-object");var e,r=[];for(e in t)a(t,e)&&r.push(e);if(p)for(e=0;f>e;e++){var i=d[e];a(t,i)&&r.push(i)}return r}}Date.prototype.toISOString&&-1!==new Date(-621987552e5).toISOString().indexOf("-000001")||(Date.prototype.toISOString=function(){var t,e,r,i;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(i=this.getUTCFullYear(),t=this.getUTCMonth(),i+=Math.floor(t/12),t=[(t%12+12)%12+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],i=(0>i?"-":i>9999?"+":"")+("00000"+Math.abs(i)).slice(i>=0&&9999>=i?-4:-6),e=t.length;e--;)r=t[e],10>r&&(t[e]="0"+r);return i+"-"+t.slice(0,2).join("-")+"T"+t.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}),l=!1;try{l=Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(-621987552e5).toJSON().indexOf("-000001")&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(I){}l||(Date.prototype.toJSON=function(){var t,e=Object(this);t:{if(!r(e)){if(t=e.valueOf,"function"==typeof t&&(t=t.call(e),r(t)))break t;if(t=e.toString,"function"==typeof t&&(t=t.call(e),r(t)))break t;throw new TypeError}t=e}if("number"==typeof t&&!isFinite(t))return null;if(t=e.toISOString,"function"!=typeof t)throw new TypeError("toISOString property is not callable");return t.call(e)});var v,g=Date,y=function(t,e,r,i,n,o,s){var a=arguments.length;return this instanceof g?(a=1==a&&t+""===t?new g(y.parse(t)):a>=7?new g(t,e,r,i,n,o,s):a>=6?new g(t,e,r,i,n,o):a>=5?new g(t,e,r,i,n):a>=4?new g(t,e,r,i):a>=3?new g(t,e,r):a>=2?new g(t,e):a>=1?new g(t):new g,a.constructor=y,a):g.apply(this,arguments)},b=function(t,e){var r=e>1?1:0;return m[e]+Math.floor((t-1969+r)/4)-Math.floor((t-1901+r)/100)+Math.floor((t-1601+r)/400)+365*(t-1970)},_=RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:\\.(\\d{3}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),m=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(v in g)y[v]=g[v];if(y.now=g.now,y.UTC=g.UTC,y.prototype=g.prototype,y.prototype.constructor=y,y.parse=function(t){var e=_.exec(t);if(e){var r=Number(e[1]),i=Number(e[2]||1)-1,n=Number(e[3]||1)-1,o=Number(e[4]||0),s=Number(e[5]||0),a=Number(e[6]||0),h=Number(e[7]||0),c=!e[4]||e[8]?0:Number(new g(1970,0)),u="-"===e[9]?1:-1,l=Number(e[10]||0),e=Number(e[11]||0);return(s>0||a>0||h>0?24:25)>o&&60>s&&60>a&&1e3>h&&i>-1&&12>i&&24>l&&60>e&&n>-1&&b(r,i+1)-b(r,i)>n&&(r=60*(24*(b(r,i)+n)+o+l*u),r=1e3*(60*(r+s+e*u)+a)+h+c,r>=-864e13&&864e13>=r)?r:0/0}return g.parse.apply(this,arguments)},Date=y,Date.now||(Date.now=function(){return(new Date).getTime()}),"0".split(void 0,0).length){var x=String.prototype.split;String.prototype.split=function(t,e){return void 0===t&&0===e?[]:x.apply(this,arguments)}}if("".substr&&"b"!=="0b".substr(-1)){var P=String.prototype.substr;String.prototype.substr=function(t,e){return P.call(this,0>t?0>(t=this.length+t)?0:t:t,e)}}if(v="	\n\f\r   ᠎             　\u2028\u2029﻿",!String.prototype.trim||v.trim()){v="["+v+"]";var T=RegExp("^"+v+v+"*"),X=RegExp(v+v+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return(this+"").replace(T,"").replace(X,"")}}var w=function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return Object(t)}}),function(t){"function"==typeof define?define(t):"function"==typeof YUI?YUI.add("es5-sham",t):t()}(function(){function t(t){try{return Object.defineProperty(t,"sentinel",{}),"sentinel"in t}catch(e){}}var e,r,i,n,o,s=Function.prototype.call,a=Object.prototype,h=s.bind(a.hasOwnProperty);if((o=h(a,"__defineGetter__"))&&(e=s.bind(a.__defineGetter__),r=s.bind(a.__defineSetter__),i=s.bind(a.__lookupGetter__),n=s.bind(a.__lookupSetter__)),Object.getPrototypeOf||(Object.getPrototypeOf=function(t){return t.__proto__||(t.constructor?t.constructor.prototype:a)}),Object.getOwnPropertyDescriptor||(Object.getOwnPropertyDescriptor=function(t,e){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.getOwnPropertyDescriptor called on a non-object: "+t);if(h(t,e)){var r={enumerable:!0,configurable:!0};if(o){var s=t.__proto__;t.__proto__=a;var c=i(t,e),u=n(t,e);if(t.__proto__=s,c||u)return c&&(r.get=c),u&&(r.set=u),r}return r.value=t[e],r}}),Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),!Object.create){var c;if(null===Object.prototype.__proto__||"undefined"==typeof document)c=function(){return{__proto__:null}};else{var u=function(){},s=document.createElement("iframe"),l=document.body||document.documentElement;s.style.display="none",l.appendChild(s),s.src="javascript:";var p=s.contentWindow.Object.prototype;l.removeChild(s),s=null,delete p.constructor,delete p.hasOwnProperty,delete p.propertyIsEnumerable,delete p.isPrototypeOf,delete p.toLocaleString,delete p.toString,delete p.valueOf,p.__proto__=null,u.prototype=p,c=function(){return new u}}Object.create=function(t,e){function r(){}var i;if(null===t)i=c();else{if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object or null");r.prototype=t,i=new r,i.__proto__=t}return void 0!==e&&Object.defineProperties(i,e),i}}if(Object.defineProperty&&(s=t({}),l="undefined"==typeof document||t(document.createElement("div")),!s||!l))var d=Object.defineProperty,f=Object.defineProperties;(!Object.defineProperty||d)&&(Object.defineProperty=function(t,s,c){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object.defineProperty called on non-object: "+t);if("object"!=typeof c&&"function"!=typeof c||null===c)throw new TypeError("Property description must be an object: "+c);if(d)try{return d.call(Object,t,s,c)}catch(u){}if(h(c,"value"))if(o&&(i(t,s)||n(t,s))){var l=t.__proto__;t.__proto__=a,delete t[s],t[s]=c.value,t.__proto__=l}else t[s]=c.value;else{if(!o)throw new TypeError("getters & setters can not be defined on this javascript engine");h(c,"get")&&e(t,s,c.get),h(c,"set")&&r(t,s,c.set)}return t}),(!Object.defineProperties||f)&&(Object.defineProperties=function(t,e){if(f)try{return f.call(Object,t,e)}catch(r){}for(var i in e)h(e,i)&&"__proto__"!=i&&Object.defineProperty(t,i,e[i]);return t}),Object.seal||(Object.seal=function(t){return t}),Object.freeze||(Object.freeze=function(t){return t});try{Object.freeze(function(){})}catch(I){var v=Object.freeze;Object.freeze=function(t){return"function"==typeof t?t:v(t)}}Object.preventExtensions||(Object.preventExtensions=function(t){return t}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)!==t)throw new TypeError;for(var e="";h(t,e);)e+="?";t[e]=!0;var r=h(t,e);return delete t[e],r})});var PIXI=PIXI||{};PIXI.Point=function(t,e){this.x=t||0,this.y=e||0},PIXI.Point.clone=function(){return new PIXI.Point(this.x,this.y)},PIXI.Point.constructor=PIXI.Point,PIXI.Rectangle=function(t,e,r,i){this.x=t||0,this.y=e||0,this.width=r||0,this.height=i||0},PIXI.Rectangle.clone=function(){return new PIXI.Rectangle(this.x,this.y,this.width,this.height)},PIXI.Rectangle.constructor=PIXI.Rectangle,PIXI.DisplayObject=function(){this.position=new PIXI.Point,this.scale=new PIXI.Point(1,1),this.rotation=0,this.alpha=1,this.visible=!0,this.cacheVisible=!1,this.parent=null,this.stage=null,this.hitArea=null,this.worldAlpha=1,this.color=[],this.worldTransform=PIXI.mat3.create(),this.localTransform=PIXI.mat3.create(),this.dynamic=!0,this._sr=0,this._cr=1,this.renderable=!1,this.interactive=!1,this.buttonMode=!1},PIXI.DisplayObject.constructor=PIXI.DisplayObject,PIXI.DisplayObject.prototype.setInteractive=function(t){this.interactive=t,this.stage&&(this.stage.dirty=!0)},PIXI.DisplayObject.prototype.updateTransform=function(){this.rotation!=this.rotationCache&&(this.rotationCache=this.rotation,this._sr=Math.sin(this.rotation),this._cr=Math.cos(this.rotation));var t=this.localTransform,e=this.parent.worldTransform,r=this.worldTransform;t[0]=this._cr*this.scale.x,t[1]=-this._sr*this.scale.y,t[3]=this._sr*this.scale.x,t[4]=this._cr*this.scale.y,t[2]=this.position.x,t[5]=this.position.y;var i=t[0],n=t[1],o=t[2],s=t[3],a=t[4],h=t[5],c=e[0],u=e[1],l=e[2],p=e[3],d=e[4],f=e[5];r[0]=c*i+u*s,r[1]=c*n+u*a,r[2]=c*o+u*h+l,r[3]=p*i+d*s,r[4]=p*n+d*a,r[5]=p*o+d*h+f,this.worldAlpha=this.alpha*this.parent.worldAlpha},PIXI.DisplayObjectContainer=function(){PIXI.DisplayObject.call(this),this.children=[],this.renderable=!1},PIXI.DisplayObjectContainer.constructor=PIXI.DisplayObjectContainer,PIXI.DisplayObjectContainer.prototype=Object.create(PIXI.DisplayObject.prototype),PIXI.DisplayObjectContainer.prototype.addChild=function(t){void 0!=t.parent&&t.parent.removeChild(t),t.parent=this,t.childIndex=this.children.length,this.children.push(t),this.stage&&this.stage.__addChild(t)},PIXI.DisplayObjectContainer.prototype.addChildAt=function(t,e){if(!(e>=0&&this.children.length>=e))throw Error(t+" The index "+e+" supplied is out of bounds "+this.children.length);void 0!=t.parent&&t.parent.removeChild(t),e==this.children.length?this.children.push(t):this.children.splice(e,0,t),t.parent=this,t.childIndex=e;for(var r=this.children.length,i=e;r>i;i++)this.children[i].childIndex=i;this.stage&&this.stage.__addChild(t)},PIXI.DisplayObjectContainer.prototype.swapChildren=function(t,e){var r=this.children.indexOf(t),i=this.children.indexOf(e);if(-1===r||-1===i)throw Error(t+" Both the supplied DisplayObjects must be a child of the caller "+this);this.stage&&(this.stage.__removeChild(t),this.stage.__removeChild(e),this.stage.__addChild(t),this.stage.__addChild(e)),t.childIndex=i,e.childIndex=r,this.children[r]=e,this.children[i]=t},PIXI.DisplayObjectContainer.prototype.getChildAt=function(t){if(t>=0&&this.children.length>t)return this.children[t];throw Error(child+" Both the supplied DisplayObjects must be a child of the caller "+this)},PIXI.DisplayObjectContainer.prototype.removeChild=function(t){var e=this.children.indexOf(t);if(-1===e)throw Error(t+" The supplied DisplayObject must be a child of the caller "+this);this.stage&&this.stage.__removeChild(t),t.parent=void 0,this.children.splice(e,1);for(var r=e,i=this.children.length;i>r;r++)this.children[r].childIndex-=1},PIXI.DisplayObjectContainer.prototype.updateTransform=function(){if(this.visible){PIXI.DisplayObject.prototype.updateTransform.call(this);for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform()}},PIXI.blendModes={},PIXI.blendModes.NORMAL=0,PIXI.blendModes.SCREEN=1,PIXI.Sprite=function(t){PIXI.DisplayObjectContainer.call(this),this.anchor=new PIXI.Point,this.texture=t,this.blendMode=PIXI.blendModes.NORMAL,this._width=0,this._height=0,t.baseTexture.hasLoaded?this.updateFrame=!0:(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},PIXI.Sprite.constructor=PIXI.Sprite,PIXI.Sprite.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),Object.defineProperty(PIXI.Sprite.prototype,"width",{get:function(){return this.scale.x*this.texture.frame.width},set:function(t){this.scale.x=t/this.texture.frame.width,this._width=t}}),Object.defineProperty(PIXI.Sprite.prototype,"height",{get:function(){return this.scale.y*this.texture.frame.height},set:function(t){this.scale.y=t/this.texture.frame.height,this._height=t}}),PIXI.Sprite.prototype.setTexture=function(t){this.texture.baseTexture!=t.baseTexture&&(this.textureChange=!0),this.texture=t,this.updateFrame=!0},PIXI.Sprite.prototype.onTextureUpdate=function(){this._width&&(this.scale.x=this._width/this.texture.frame.width),this._height&&(this.scale.y=this._height/this.texture.frame.height),this.updateFrame=!0},PIXI.Sprite.fromFrame=function(t){var e=PIXI.TextureCache[t];if(!e)throw Error("The frameId '"+t+"' does not exist in the texture cache"+this);return new PIXI.Sprite(e)},PIXI.Sprite.fromImage=function(t){var e=PIXI.Texture.fromImage(t);return new PIXI.Sprite(e)},PIXI.MovieClip=function(t){PIXI.Sprite.call(this,t[0]),this.textures=t,this.currentFrame=0,this.animationSpeed=1,this.loop=!0,this.onComplete=null,this.playing},PIXI.MovieClip.constructor=PIXI.MovieClip,PIXI.MovieClip.prototype=Object.create(PIXI.Sprite.prototype),PIXI.MovieClip.prototype.stop=function(){this.playing=!1},PIXI.MovieClip.prototype.play=function(){this.playing=!0},PIXI.MovieClip.prototype.gotoAndStop=function(t){this.playing=!1,this.currentFrame=t;var e=0|this.currentFrame+.5;this.setTexture(this.textures[e%this.textures.length])},PIXI.MovieClip.prototype.gotoAndPlay=function(t){this.currentFrame=t,this.playing=!0},PIXI.MovieClip.prototype.updateTransform=function(){if(PIXI.Sprite.prototype.updateTransform.call(this),this.playing){this.currentFrame+=this.animationSpeed;var t=0|this.currentFrame+.5;this.loop||this.textures.length>t?this.setTexture(this.textures[t%this.textures.length]):t>=this.textures.length&&(this.gotoAndStop(this.textures.length-1),this.onComplete&&this.onComplete())}},PIXI.InteractionManager=function(t){this.stage=t,this.tempPoint=new PIXI.Point,this.mouseoverEnabled=!0,this.mouse=new PIXI.InteractionData,this.touchs={},this.pool=[],this.interactiveItems=[],this.last=0},PIXI.InteractionManager.constructor=PIXI.InteractionManager,PIXI.InteractionManager.prototype.collectInteractiveSprite=function(t,e){for(var r=t.children,i=r.length,n=i-1;n>=0;n--){var o=r[n];o.interactive?(e.interactiveChildren=!0,this.interactiveItems.push(o),o.children.length>0&&this.collectInteractiveSprite(o,o)):(o.__iParent=null,o.children.length>0&&this.collectInteractiveSprite(o,e))}},PIXI.InteractionManager.prototype.setTarget=function(t){window.navigator.msPointerEnabled&&(t.view.style["-ms-content-zooming"]="none",t.view.style["-ms-touch-action"]="none"),this.target=t,t.view.addEventListener("mousemove",this.onMouseMove.bind(this),!0),t.view.addEventListener("mousedown",this.onMouseDown.bind(this),!0),document.body.addEventListener("mouseup",this.onMouseUp.bind(this),!0),t.view.addEventListener("mouseout",this.onMouseUp.bind(this),!0),t.view.addEventListener("touchstart",this.onTouchStart.bind(this),!0),t.view.addEventListener("touchend",this.onTouchEnd.bind(this),!0),t.view.addEventListener("touchmove",this.onTouchMove.bind(this),!0)},PIXI.InteractionManager.prototype.update=function(){var t=Date.now(),e=t-this.last;if(e=30*e/1e3,!(1>e)){if(this.last=t,this.dirty){this.dirty=!1,this.interactiveItems.length;for(var r=0;this.interactiveItems.length>r;r++)this.interactiveItems[r].interactiveChildren=!0;this.interactiveItems=[],this.stage.interactive&&this.interactiveItems.push(this.stage),this.collectInteractiveSprite(this.stage,this.stage)}for(var i=this.interactiveItems.length,r=0;i>r;r++){var n=this.interactiveItems[r];n.visible&&(n.mouseover||n.mouseout||n.buttonMode)&&(n.__hit=this.hitTest(n,this.mouse),n.__hit?n.__isOver||(n.buttonMode&&(this.target.view.style.cursor="pointer"),n.mouseover&&n.mouseover(this.mouse),n.__isOver=!0):n.__isOver&&(n.buttonMode&&(this.target.view.style.cursor="default"),n.mouseout&&n.mouseout(this.mouse),n.__isOver=!1))}}},PIXI.InteractionManager.prototype.onMouseMove=function(t){t.preventDefault();var e=this.target.view.getBoundingClientRect();this.mouse.global.x=(t.clientX-e.left)*(this.target.width/e.width),this.mouse.global.y=(t.clientY-e.top)*(this.target.height/e.height);var r=this.interactiveItems.length;this.mouse.global;for(var i=0;r>i;i++){var n=this.interactiveItems[i];n.mousemove&&n.mousemove(this.mouse)}},PIXI.InteractionManager.prototype.onMouseDown=function(t){t.preventDefault();var e=this.interactiveItems.length;this.mouse.global,this.stage;for(var r=0;e>r;r++){var i=this.interactiveItems[r];if((i.mousedown||i.click)&&(i.__mouseIsDown=!0,i.__hit=this.hitTest(i,this.mouse),i.__hit&&(i.mousedown&&i.mousedown(this.mouse),i.__isDown=!0,!i.interactiveChildren)))break}},PIXI.InteractionManager.prototype.onMouseUp=function(t){t.preventDefault(),this.mouse.global;for(var e=this.interactiveItems.length,r=!1,i=0;e>i;i++){var n=this.interactiveItems[i];(n.mouseup||n.mouseupoutside||n.click)&&(n.__hit=this.hitTest(n,this.mouse),n.__hit&&!r?(n.mouseup&&n.mouseup(this.mouse),n.__isDown&&n.click&&n.click(this.mouse),n.interactiveChildren||(r=!0)):n.__isDown&&n.mouseupoutside&&n.mouseupoutside(this.mouse),n.__isDown=!1)}},PIXI.InteractionManager.prototype.hitTest=function(t,e){var r=e.global;if(!t.visible)return!1;if(t instanceof PIXI.Sprite){var i=t.worldTransform,n=i[0],o=i[1],s=i[2],a=i[3],h=i[4],c=i[5],u=1/(n*h+o*-a),l=h*u*r.x+-o*u*r.y+(c*o-s*h)*u,p=n*u*r.y+-a*u*r.x+(-c*n+s*a)*u,d=t.texture.frame.width,f=t.texture.frame.height,I=-d*t.anchor.x;if(l>I&&I+d>l){var v=-f*t.anchor.y;if(p>v&&v+f>p)return!0}}else if(t.hitArea){var i=t.worldTransform,g=t.hitArea,n=i[0],o=i[1],s=i[2],a=i[3],h=i[4],c=i[5],u=1/(n*h+o*-a),l=h*u*r.x+-o*u*r.y+(c*o-s*h)*u,p=n*u*r.y+-a*u*r.x+(-c*n+s*a)*u,I=g.x;if(l>I&&I+g.width>l){var v=g.y;if(p>v&&v+g.height>p)return!0}}for(var y=t.children.length,b=0;y>b;b++){var _=t.children[b],m=this.hitTest(_,e);if(m)return!0}return!1},PIXI.InteractionManager.prototype.onTouchMove=function(t){t.preventDefault();for(var e=this.target.view.getBoundingClientRect(),r=t.changedTouches,i=0;r.length>i;i++){var n=r[i],o=this.touchs[n.identifier];o.global.x=(n.clientX-e.left)*(this.target.width/e.width),o.global.y=(n.clientY-e.top)*(this.target.height/e.height)}for(var s=this.interactiveItems.length,i=0;s>i;i++){var a=this.interactiveItems[i];a.touchmove&&a.touchmove(o)}},PIXI.InteractionManager.prototype.onTouchStart=function(t){t.preventDefault();for(var e=this.target.view.getBoundingClientRect(),r=t.changedTouches,i=0;r.length>i;i++){var n=r[i],o=this.pool.pop();o||(o=new PIXI.InteractionData),this.touchs[n.identifier]=o,o.global.x=(n.clientX-e.left)*(this.target.width/e.width),o.global.y=(n.clientY-e.top)*(this.target.height/e.height);for(var s=this.interactiveItems.length,a=0;s>a;a++){var h=this.interactiveItems[a];if((h.touchstart||h.tap)&&(h.__hit=this.hitTest(h,o),h.__hit&&(h.touchstart&&h.touchstart(o),h.__isDown=!0,h.__touchData=o,!h.interactiveChildren)))break}}},PIXI.InteractionManager.prototype.onTouchEnd=function(t){t.preventDefault();for(var e=this.target.view.getBoundingClientRect(),r=t.changedTouches,i=0;r.length>i;i++){var n=r[i],o=this.touchs[n.identifier],s=!1;o.global.x=(n.clientX-e.left)*(this.target.width/e.width),o.global.y=(n.clientY-e.top)*(this.target.height/e.height);for(var a=this.interactiveItems.length,h=0;a>h;h++){var c=this.interactiveItems[h],u=c.__touchData;c.__hit=this.hitTest(c,o),u==o&&((c.touchend||c.tap)&&(c.__hit&&!s?(c.touchend&&c.touchend(o),c.__isDown&&c.tap&&c.tap(o),c.interactiveChildren||(s=!0)):c.__isDown&&c.touchendoutside&&c.touchendoutside(o),c.__isDown=!1),c.__touchData=null)}this.pool.push(o),this.touchs[n.identifier]=null}},PIXI.InteractionData=function(){this.global=new PIXI.Point,this.local=new PIXI.Point,this.target},PIXI.InteractionData.prototype.getLocalPosition=function(t){var e=t.worldTransform,r=this.global,i=e[0],n=e[1],o=e[2],s=e[3],a=e[4],h=e[5],c=1/(i*a+n*-s);return new PIXI.Point(a*c*r.x+-n*c*r.y+(h*n-o*a)*c,i*c*r.y+-s*c*r.x+(-h*i+o*s)*c)},PIXI.InteractionData.constructor=PIXI.InteractionData,PIXI.Stage=function(t,e){PIXI.DisplayObjectContainer.call(this),this.worldTransform=PIXI.mat3.create(),this.__childrenAdded=[],this.__childrenRemoved=[],this.childIndex=0,this.stage=this,this.stage.hitArea=new PIXI.Rectangle(0,0,1e5,1e5),this.interactive=!!e,this.interactionManager=new PIXI.InteractionManager(this),this.setBackgroundColor(t)},PIXI.Stage.constructor=PIXI.Stage,PIXI.Stage.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Stage.prototype.updateTransform=function(){this.worldAlpha=1;for(var t=0,e=this.children.length;e>t;t++)this.children[t].updateTransform();this.dirty&&(this.dirty=!1,this.interactionManager.dirty=!0),this.interactive&&this.interactionManager.update()},PIXI.Stage.prototype.setBackgroundColor=function(t){this.backgroundColor=t||0,this.backgroundColorSplit=HEXtoRGB(this.backgroundColor),this.backgroundColorString="#"+this.backgroundColor.toString(16)},PIXI.Stage.prototype.getMousePosition=function(){return this.interactionManager.mouse.global},PIXI.Stage.prototype.__addChild=function(t){if(t.interactive&&(this.dirty=!0),t.stage=this,t.children)for(var e=0;t.children.length>e;e++)this.__addChild(t.children[e])},PIXI.Stage.prototype.__removeChild=function(t){if(t.interactive&&(this.dirty=!0),this.__childrenRemoved.push(t),t.stage=void 0,t.children)for(var e=0,r=t.children.length;r>e;e++)this.__removeChild(t.children[e])},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)}}(),"function"!=typeof Function.prototype.bind&&(Function.prototype.bind=function(){var t=Array.prototype.slice;return function(e){function r(){var o=n.concat(t.call(arguments));i.apply(this instanceof r?this:e,o)}var i=this,n=t.call(arguments,1);if("function"!=typeof i)throw new TypeError;return r.prototype=function o(t){return t&&(o.prototype=t),this instanceof o?void 0:new o}(i.prototype),r}}());var AjaxRequest=function(){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(!window.ActiveXObject)return window.XMLHttpRequest?new XMLHttpRequest:!1;for(var e=0;t.length>e;e++)try{return new ActiveXObject(t[e])}catch(r){}};PIXI.EventTarget=function(){var t={};this.addEventListener=this.on=function(e,r){void 0===t[e]&&(t[e]=[]),-1===t[e].indexOf(r)&&t[e].push(r)},this.dispatchEvent=this.emit=function(e){for(var r in t[e.type])t[e.type][r](e)},this.removeEventListener=this.off=function(e,r){var i=t[e].indexOf(r);-1!==i&&t[e].splice(i,1)}},determineMatrixArrayType(),PIXI.mat3={},PIXI.mat3.create=function(){var t=new PIXI.Matrix(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},PIXI.mat4={},PIXI.mat4.create=function(){var t=new PIXI.Matrix(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},PIXI.mat3.multiply=function(t,e,r){r||(r=t);var i=t[0],n=t[1],o=t[2],s=t[3],a=t[4],h=t[5],c=t[6],u=t[7],l=t[8],p=e[0],d=e[1],f=e[2],I=e[3],v=e[4],g=e[5],y=e[6],b=e[7],_=e[8];return r[0]=p*i+d*s+f*c,r[1]=p*n+d*a+f*u,r[2]=p*o+d*h+f*l,r[3]=I*i+v*s+g*c,r[4]=I*n+v*a+g*u,r[5]=I*o+v*h+g*l,r[6]=y*i+b*s+_*c,r[7]=y*n+b*a+_*u,r[8]=y*o+b*h+_*l,r
},PIXI.mat3.toMat4=function(t,e){return e||(e=PIXI.mat4.create()),e[15]=1,e[14]=0,e[13]=0,e[12]=0,e[11]=0,e[10]=t[8],e[9]=t[7],e[8]=t[6],e[7]=0,e[6]=t[5],e[5]=t[4],e[4]=t[3],e[3]=0,e[2]=t[2],e[1]=t[1],e[0]=t[0],e},PIXI.mat4.create=function(){var t=new PIXI.Matrix(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},PIXI.mat4.transpose=function(t,e){if(!e||t===e){var r=t[1],i=t[2],n=t[3],o=t[6],s=t[7],a=t[11];return t[1]=t[4],t[2]=t[8],t[3]=t[12],t[4]=r,t[6]=t[9],t[7]=t[13],t[8]=i,t[9]=o,t[11]=t[14],t[12]=n,t[13]=s,t[14]=a,t}return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e},PIXI.mat4.multiply=function(t,e,r){r||(r=t);var i=t[0],n=t[1],o=t[2],s=t[3],a=t[4],h=t[5],c=t[6],u=t[7],l=t[8],p=t[9],d=t[10],f=t[11],I=t[12],v=t[13],g=t[14],y=t[15],b=e[0],_=e[1],m=e[2],x=e[3];return r[0]=b*i+_*a+m*l+x*I,r[1]=b*n+_*h+m*p+x*v,r[2]=b*o+_*c+m*d+x*g,r[3]=b*s+_*u+m*f+x*y,b=e[4],_=e[5],m=e[6],x=e[7],r[4]=b*i+_*a+m*l+x*I,r[5]=b*n+_*h+m*p+x*v,r[6]=b*o+_*c+m*d+x*g,r[7]=b*s+_*u+m*f+x*y,b=e[8],_=e[9],m=e[10],x=e[11],r[8]=b*i+_*a+m*l+x*I,r[9]=b*n+_*h+m*p+x*v,r[10]=b*o+_*c+m*d+x*g,r[11]=b*s+_*u+m*f+x*y,b=e[12],_=e[13],m=e[14],x=e[15],r[12]=b*i+_*a+m*l+x*I,r[13]=b*n+_*h+m*p+x*v,r[14]=b*o+_*c+m*d+x*g,r[15]=b*s+_*u+m*f+x*y,r},PIXI.autoDetectRenderer=function(t,e,r,i){t||(t=800),e||(e=600);var n=function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(t){return!1}}();return n?new PIXI.WebGLRenderer(t,e,r,i):new PIXI.CanvasRenderer(t,e,r,i)},PIXI.shaderFragmentSrc=["precision mediump float;","varying vec2 vTextureCoord;","varying float vColor;","uniform sampler2D uSampler;","void main(void) {","gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.x, vTextureCoord.y));","gl_FragColor = gl_FragColor * vColor;","}"],PIXI.shaderVertexSrc=["attribute vec2 aVertexPosition;","attribute vec2 aTextureCoord;","attribute float aColor;","uniform mat4 uMVMatrix;","varying vec2 vTextureCoord;","varying float vColor;","void main(void) {","gl_Position = uMVMatrix * vec4(aVertexPosition, 1.0, 1.0);","vTextureCoord = aTextureCoord;","vColor = aColor;","}"],PIXI.CompileVertexShader=function(t,e){for(var r="",i=0;e.length>i;i++)r+=e[i];var n;return n=t.createShader(t.VERTEX_SHADER),t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert(t.getShaderInfoLog(n)),null)},PIXI.CompileFragmentShader=function(t,e){for(var r="",i=0;e.length>i;i++)r+=e[i];var n;return n=t.createShader(t.FRAGMENT_SHADER),t.shaderSource(n,r),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS)?n:(alert(t.getShaderInfoLog(n)),null)},PIXI._defaultFrame=new PIXI.Rectangle(0,0,1,1),PIXI.WebGLRenderer=function(t,e,r,i){this.transparent=!!i,this.width=t||800,this.height=e||600,this.view=r||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height;var n=this;this.view.addEventListener("webglcontextlost",function(t){n.handleContextLost(t)},!1),this.view.addEventListener("webglcontextrestored",function(t){n.handleContextRestored(t)},!1),this.batchs=[];try{this.gl=this.view.getContext("experimental-webgl",{alpha:this.transparent,antialias:!1,premultipliedAlpha:!0})}catch(o){throw Error(" This browser does not support webGL. Try using the canvas renderer"+this)}this.initShaders();var s=this.gl;this.batch=new PIXI.WebGLBatch(s),s.disable(s.DEPTH_TEST),s.enable(s.BLEND),s.colorMask(!0,!0,!0,this.transparent),this.projectionMatrix=PIXI.mat4.create(),this.resize(this.width,this.height),this.contextLost=!1},PIXI.WebGLRenderer.constructor=PIXI.WebGLRenderer,PIXI.WebGLRenderer.prototype.initShaders=function(){var t=this.gl,e=PIXI.CompileFragmentShader(t,PIXI.shaderFragmentSrc),r=PIXI.CompileVertexShader(t,PIXI.shaderVertexSrc);this.shaderProgram=t.createProgram();var i=this.shaderProgram;t.attachShader(i,r),t.attachShader(i,e),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)||alert("Could not initialise shaders"),t.useProgram(i),i.vertexPositionAttribute=t.getAttribLocation(i,"aVertexPosition"),t.enableVertexAttribArray(i.vertexPositionAttribute),i.textureCoordAttribute=t.getAttribLocation(i,"aTextureCoord"),t.enableVertexAttribArray(i.textureCoordAttribute),i.colorAttribute=t.getAttribLocation(i,"aColor"),t.enableVertexAttribArray(i.colorAttribute),i.mvMatrixUniform=t.getUniformLocation(i,"uMVMatrix"),i.samplerUniform=t.getUniformLocation(i,"uSampler"),PIXI.shaderProgram=this.shaderProgram},PIXI.WebGLRenderer.prototype.checkVisibility=function(t,e){for(var r=t.children,i=0;r.length>i;i++){var n=r[i],o=n.visible&&e;n.textureChange&&(n.textureChange=!1,o&&(this.removeDisplayObject(n),this.addDisplayObject(n))),n.cacheVisible!=o&&(n.cacheVisible=o,n.cacheVisible?this.addDisplayObject(n):this.removeDisplayObject(n)),n.children.length>0&&this.checkVisibility(n,o)}},PIXI.WebGLRenderer.prototype.render=function(t){if(!this.contextLost){this.__stage!==t&&(this.__stage&&this.checkVisibility(this.__stage,!1),this.__stage=t);for(var e=0;t.__childrenRemoved.length>e;e++)this.removeDisplayObject(t.__childrenRemoved[e]);for(var e=0;PIXI.texturesToUpdate.length>e;e++)this.updateTexture(PIXI.texturesToUpdate[e]);t.__childrenRemoved=[],t.__childrenAdded=[],PIXI.texturesToUpdate=[],this.checkVisibility(t,!0),t.updateTransform();var r=this.gl;r.clear(r.COLOR_BUFFER_BIT),r.clearColor(t.backgroundColorSplit[0],t.backgroundColorSplit[1],t.backgroundColorSplit[2],0),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.projectionMatrix);for(var i,e=0;this.batchs.length>e;e++)i=this.batchs[e],i instanceof PIXI.WebGLBatch?this.batchs[e].render():i instanceof PIXI.TilingSprite?i.visible&&this.renderTilingSprite(i):i instanceof PIXI.Strip&&i.visible&&this.renderStrip(i);if(t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),PIXI.Texture.frameUpdates.length>0){for(var e=0;PIXI.Texture.frameUpdates.length>e;e++)PIXI.Texture.frameUpdates[e].updateFrame=!1;PIXI.Texture.frameUpdates=[]}}},PIXI.WebGLRenderer.prototype.updateTexture=function(t){var e=this.gl;t._glTexture||(t._glTexture=e.createTexture()),t.hasLoaded&&(e.bindTexture(e.TEXTURE_2D,t._glTexture),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t.source),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),t._powerOf2?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.bindTexture(e.TEXTURE_2D,null)),this.refreshBatchs=!0},PIXI.WebGLRenderer.prototype.addDisplayObject=function(t){if(t.stage&&!t.__inWebGL&&(t.batch=null,t.renderable)){t.__inWebGL=!0;var e=t;do{if(0==e.childIndex)e=e.parent;else for(e=e.parent.children[e.childIndex-1];0!=e.children.length;)e=e.children[e.children.length-1];if(e==t.stage)break}while(!e.renderable||!e.__inWebGL);var r=t;do{if(0==r.children.length){for(;r.childIndex==r.parent.children.length-1;)if(r=r.parent,r==t.stage){r=null;break}r&&(r=r.parent.children[r.childIndex+1])}else r=r.children[0];if(!r)break}while(!r.renderable||!r.__inWebGL);if(t instanceof PIXI.Sprite){var i,n;if(e instanceof PIXI.Sprite){if(i=e.batch,i&&i.texture==t.texture.baseTexture&&i.blendMode==t.blendMode)return i.insertAfter(t,e),void 0}else i=e;if(r)if(r instanceof PIXI.Sprite){if(n=r.batch){if(n.texture==t.texture.baseTexture&&n.blendMode==t.blendMode)return n.insertBefore(t,r),void 0;if(n==i){var o=i.split(r),s=PIXI._getBatch(this.gl),a=this.batchs.indexOf(i);return s.init(t),this.batchs.splice(a+1,0,s,o),void 0}}}else n=r;var s=PIXI._getBatch(this.gl);if(s.init(t),i){var a=this.batchs.indexOf(i);this.batchs.splice(a+1,0,s)}else this.batchs.push(s)}else t instanceof PIXI.TilingSprite?(this.initTilingSprite(t),this.batchs.push(t)):t instanceof PIXI.Strip&&(this.initStrip(t),this.batchs.push(t));this.batchUpdate=!0}},PIXI.WebGLRenderer.prototype.removeDisplayObject=function(t){if(t.cacheVisible=!1,t.renderable){t.__inWebGL=!1;var e;if(t instanceof PIXI.Sprite){var r=t.batch;if(!r)return;r.remove(t),0==r.size&&(e=r)}else e=t;if(e){var i=this.batchs.indexOf(e);if(-1==i)return;if(0==i||i==this.batchs.length-1)return this.batchs.splice(i,1),e instanceof PIXI.WebGLBatch&&PIXI._returnBatch(e),void 0;if(this.batchs[i-1]instanceof PIXI.WebGLBatch&&this.batchs[i+1]instanceof PIXI.WebGLBatch&&this.batchs[i-1].texture==this.batchs[i+1].texture&&this.batchs[i-1].blendMode==this.batchs[i+1].blendMode)return this.batchs[i-1].merge(this.batchs[i+1]),e instanceof PIXI.WebGLBatch&&PIXI._returnBatch(e),PIXI._returnBatch(this.batchs[i+1]),this.batchs.splice(i,2),void 0;this.batchs.splice(i,1),e instanceof PIXI.WebGLBatch&&PIXI._returnBatch(e)}}},PIXI.WebGLRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e,this.gl.viewport(0,0,this.width,this.height);var r=this.projectionMatrix;r[0]=2/this.width,r[5]=-2/this.height,r[12]=-1,r[13]=1},PIXI.WebGLRenderer.prototype.initTilingSprite=function(t){var e=this.gl;t.verticies=new Float32Array([0,0,t.width,0,t.width,t.height,0,t.height]),t.uvs=new Float32Array([0,0,1,0,1,1,0,1]),t.colors=new Float32Array([1,1,1,1]),t.indices=new Uint16Array([0,1,3,2]),t._vertexBuffer=e.createBuffer(),t._indexBuffer=e.createBuffer(),t._uvBuffer=e.createBuffer(),t._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.verticies,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW),t.texture.baseTexture._glTexture?(e.bindTexture(e.TEXTURE_2D,t.texture.baseTexture._glTexture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),t.texture.baseTexture._powerOf2=!0):t.texture.baseTexture._powerOf2=!0},PIXI.WebGLRenderer.prototype.renderTilingSprite=function(t){var e=this.gl;this.shaderProgram;var r=t.tilePosition,i=t.tileScale,n=r.x/t.texture.baseTexture.width,o=r.y/t.texture.baseTexture.height,s=t.width/t.texture.baseTexture.width/i.x,a=t.height/t.texture.baseTexture.height/i.y;t.uvs[0]=0+n,t.uvs[1]=0-o,t.uvs[2]=1*s+n,t.uvs[3]=0-o,t.uvs[4]=1*s+n,t.uvs[5]=1*a-o,t.uvs[6]=0+n,t.uvs[7]=1*a-o,e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,t.uvs),this.renderStrip(t)},PIXI.WebGLRenderer.prototype.initStrip=function(t){var e=this.gl;this.shaderProgram,t._vertexBuffer=e.createBuffer(),t._indexBuffer=e.createBuffer(),t._uvBuffer=e.createBuffer(),t._colorBuffer=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.verticies,e.DYNAMIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW)},PIXI.WebGLRenderer.prototype.renderStrip=function(t){var e=this.gl,r=this.shaderProgram,i=PIXI.mat3.toMat4(t.worldTransform);PIXI.mat4.transpose(i),PIXI.mat4.multiply(this.projectionMatrix,i,i),e.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,i),t.blendMode==PIXI.blendModes.NORMAL?e.blendFunc(e.ONE,e.ONE_MINUS_SRC_ALPHA):e.blendFunc(e.ONE,e.ONE_MINUS_SRC_COLOR),t.dirty?(t.dirty=!1,e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferData(e.ARRAY_BUFFER,t.verticies,e.STATIC_DRAW),e.vertexAttribPointer(r.vertexPositionAttribute,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.bufferData(e.ARRAY_BUFFER,t.uvs,e.STATIC_DRAW),e.vertexAttribPointer(r.textureCoordAttribute,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture.baseTexture._glTexture),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.bufferData(e.ARRAY_BUFFER,t.colors,e.STATIC_DRAW),e.vertexAttribPointer(r.colorAttribute,1,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,t.indices,e.STATIC_DRAW)):(e.bindBuffer(e.ARRAY_BUFFER,t._vertexBuffer),e.bufferSubData(e.ARRAY_BUFFER,0,t.verticies),e.vertexAttribPointer(r.vertexPositionAttribute,2,e.FLOAT,!1,0,0),e.bindBuffer(e.ARRAY_BUFFER,t._uvBuffer),e.vertexAttribPointer(r.textureCoordAttribute,2,e.FLOAT,!1,0,0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t.texture.baseTexture._glTexture),e.bindBuffer(e.ARRAY_BUFFER,t._colorBuffer),e.vertexAttribPointer(r.colorAttribute,1,e.FLOAT,!1,0,0),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._indexBuffer)),e.drawElements(e.TRIANGLE_STRIP,t.indices.length,e.UNSIGNED_SHORT,0),e.uniformMatrix4fv(this.shaderProgram.mvMatrixUniform,!1,this.projectionMatrix)},PIXI.WebGLRenderer.prototype.handleContextLost=function(t){t.preventDefault(),this.contextLost=!0},PIXI.WebGLRenderer.prototype.handleContextRestored=function(){this.gl=this.view.getContext("experimental-webgl",{alpha:!0}),this.initShaders();for(var t=0;PIXI.TextureCache.length>t;t++)this.updateTexture(PIXI.TextureCache[t]);for(var t=0;this.batchs.length>t;t++)this.batchs[t].restoreLostContext(this.gl),this.batchs[t].dirty=!0;PIXI._restoreBatchs(this.gl),this.contextLost=!1},PIXI._batchs=[],PIXI._getBatch=function(t){return 0==PIXI._batchs.length?new PIXI.WebGLBatch(t):PIXI._batchs.pop()},PIXI._returnBatch=function(t){t.clean(),PIXI._batchs.push(t)},PIXI._restoreBatchs=function(t){for(var e=0;PIXI._batchs.length>e;e++)PIXI._batchs[e].restoreLostContext(t)},PIXI.WebGLBatch=function(t){this.gl=t,this.size=0,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer(),this.blendMode=PIXI.blendModes.NORMAL,this.dynamicSize=1},PIXI.WebGLBatch.constructor=PIXI.WebGLBatch,PIXI.WebGLBatch.prototype.clean=function(){this.verticies=[],this.uvs=[],this.indices=[],this.colors=[],this.dynamicSize=1,this.texture=null,this.last=null,this.size=0,this.head,this.tail},PIXI.WebGLBatch.prototype.restoreLostContext=function(t){this.gl=t,this.vertexBuffer=t.createBuffer(),this.indexBuffer=t.createBuffer(),this.uvBuffer=t.createBuffer(),this.colorBuffer=t.createBuffer()},PIXI.WebGLBatch.prototype.init=function(t){t.batch=this,this.dirty=!0,this.blendMode=t.blendMode,this.texture=t.texture.baseTexture,this.head=t,this.tail=t,this.size=1,this.growBatch()},PIXI.WebGLBatch.prototype.insertBefore=function(t,e){this.size++,t.batch=this,this.dirty=!0;var r=e.__prev;e.__prev=t,t.__next=e,r?(t.__prev=r,r.__next=t):this.head=t},PIXI.WebGLBatch.prototype.insertAfter=function(t,e){this.size++,t.batch=this,this.dirty=!0;var r=e.__next;e.__next=t,t.__prev=e,r?(t.__next=r,r.__prev=t):this.tail=t},PIXI.WebGLBatch.prototype.remove=function(t){return this.size--,0==this.size?(t.batch=null,t.__prev=null,t.__next=null,void 0):(t.__prev?t.__prev.__next=t.__next:(this.head=t.__next,this.head.__prev=null),t.__next?t.__next.__prev=t.__prev:(this.tail=t.__prev,this.tail.__next=null),t.batch=null,t.__next=null,t.__prev=null,this.dirty=!0,void 0)},PIXI.WebGLBatch.prototype.split=function(t){this.dirty=!0;var e=new PIXI.WebGLBatch(this.gl);e.init(t),e.tail=this.tail,this.tail=t.__prev,this.tail.__next=null,t.__prev=null;for(var r=0;t;)r++,t.batch=e,t=t.__next;return e.size=r,this.size-=r,e},PIXI.WebGLBatch.prototype.merge=function(t){this.dirty=!0,this.tail.__next=t.head,t.head.__prev=this.tail,this.size+=t.size,this.tail=t.tail;for(var e=t.head;e;)e.batch=this,e=e.__next},PIXI.WebGLBatch.prototype.growBatch=function(){var t=this.gl;this.dynamicSize=1==this.size?1:1.5*this.size,this.verticies=new Float32Array(8*this.dynamicSize),t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferData(t.ARRAY_BUFFER,this.verticies,t.DYNAMIC_DRAW),this.uvs=new Float32Array(8*this.dynamicSize),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),t.bufferData(t.ARRAY_BUFFER,this.uvs,t.DYNAMIC_DRAW),this.dirtyUVS=!0,this.colors=new Float32Array(4*this.dynamicSize),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),t.bufferData(t.ARRAY_BUFFER,this.colors,t.DYNAMIC_DRAW),this.dirtyColors=!0,this.indices=new Uint16Array(6*this.dynamicSize);for(var e=this.indices.length/6,r=0;e>r;r++){var i=6*r,n=4*r;this.indices[i+0]=n+0,this.indices[i+1]=n+1,this.indices[i+2]=n+2,this.indices[i+3]=n+0,this.indices[i+4]=n+2,this.indices[i+5]=n+3}t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW)},PIXI.WebGLBatch.prototype.refresh=function(){this.gl,this.dynamicSize<this.size&&this.growBatch();for(var t,e=0,r=this.head;r;){t=8*e;var i=r.texture,n=i.frame,o=i.baseTexture.width,s=i.baseTexture.height;this.uvs[t+0]=n.x/o,this.uvs[t+1]=n.y/s,this.uvs[t+2]=(n.x+n.width)/o,this.uvs[t+3]=n.y/s,this.uvs[t+4]=(n.x+n.width)/o,this.uvs[t+5]=(n.y+n.height)/s,this.uvs[t+6]=n.x/o,this.uvs[t+7]=(n.y+n.height)/s,r.updateFrame=!1,colorIndex=4*e,this.colors[colorIndex]=this.colors[colorIndex+1]=this.colors[colorIndex+2]=this.colors[colorIndex+3]=r.worldAlpha,r=r.__next,e++}this.dirtyUVS=!0,this.dirtyColors=!0},PIXI.WebGLBatch.prototype.update=function(){this.gl;for(var t,e,r,i,n,o,s,a,h,c,u,l,p,d,f,I,v=0,g=this.head;g;){if(e=g.texture.frame.width,r=g.texture.frame.height,i=g.anchor.x-g.texture.trim.x,n=g.anchor.y-g.texture.trim.y,o=e*(1-i),s=e*-i,a=r*(1-n),h=r*-n,c=8*v,t=g.worldTransform,u=t[0],l=t[3],p=t[1],d=t[4],f=t[2],I=t[5],this.verticies[c+0]=u*s+p*h+f,this.verticies[c+1]=d*h+l*s+I,this.verticies[c+2]=u*o+p*h+f,this.verticies[c+3]=d*h+l*o+I,this.verticies[c+4]=u*o+p*a+f,this.verticies[c+5]=d*a+l*o+I,this.verticies[c+6]=u*s+p*a+f,this.verticies[c+7]=d*a+l*s+I,g.updateFrame||g.texture.updateFrame){this.dirtyUVS=!0;var y=g.texture,b=y.frame,_=y.baseTexture.width,m=y.baseTexture.height;this.uvs[c+0]=b.x/_,this.uvs[c+1]=b.y/m,this.uvs[c+2]=(b.x+b.width)/_,this.uvs[c+3]=b.y/m,this.uvs[c+4]=(b.x+b.width)/_,this.uvs[c+5]=(b.y+b.height)/m,this.uvs[c+6]=b.x/_,this.uvs[c+7]=(b.y+b.height)/m,g.updateFrame=!1}if(g.cacheAlpha!=g.worldAlpha){g.cacheAlpha=g.worldAlpha;var x=4*v;this.colors[x]=this.colors[x+1]=this.colors[x+2]=this.colors[x+3]=g.worldAlpha,this.dirtyColors=!0}v++,g=g.__next}},PIXI.WebGLBatch.prototype.render=function(){if(this.dirty&&(this.refresh(),this.dirty=!1),0!=this.size){this.update();var t=this.gl;this.blendMode==PIXI.blendModes.NORMAL?t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA):t.blendFunc(t.ONE,t.ONE_MINUS_SRC_COLOR);var e=PIXI.shaderProgram;t.bindBuffer(t.ARRAY_BUFFER,this.vertexBuffer),t.bufferSubData(t.ARRAY_BUFFER,0,this.verticies),t.vertexAttribPointer(e.vertexPositionAttribute,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,this.uvBuffer),this.dirtyUVS&&(this.dirtyUVS=!1,t.bufferSubData(t.ARRAY_BUFFER,0,this.uvs)),t.vertexAttribPointer(e.textureCoordAttribute,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture._glTexture),t.bindBuffer(t.ARRAY_BUFFER,this.colorBuffer),this.dirtyColors&&(this.dirtyColors=!1,t.bufferSubData(t.ARRAY_BUFFER,0,this.colors)),t.vertexAttribPointer(e.colorAttribute,1,t.FLOAT,!1,0,0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.indexBuffer),t.drawElements(t.TRIANGLES,6*this.size,t.UNSIGNED_SHORT,0)}},PIXI.CanvasRenderer=function(t,e,r,i){this.transparent=i,this.width=t||800,this.height=e||600,this.refresh=!0,this.view=r||document.createElement("canvas"),this.view.width=this.width,this.view.height=this.height,this.count=0,this.context=this.view.getContext("2d")},PIXI.CanvasRenderer.constructor=PIXI.CanvasRenderer,PIXI.CanvasRenderer.prototype.render=function(t){t.__childrenAdded=[],t.__childrenRemoved=[],PIXI.texturesToUpdate=[],this.context.setTransform(1,0,0,1,0,0),t.updateTransform(),this.context.setTransform(1,0,0,1,0,0),this.view.style.backgroundColor==t.backgroundColorString||this.transparent||(this.view.style.backgroundColor=t.backgroundColorString),this.context.clearRect(0,0,this.width,this.height),this.renderDisplayObject(t),t.interactive&&(t._interactiveEventsAdded||(t._interactiveEventsAdded=!0,t.interactionManager.setTarget(this))),PIXI.Texture.frameUpdates.length>0&&(PIXI.Texture.frameUpdates=[])},PIXI.CanvasRenderer.prototype.resize=function(t,e){this.width=t,this.height=e,this.view.width=t,this.view.height=e},PIXI.CanvasRenderer.prototype.renderDisplayObject=function(t){var e=t.worldTransform,r=this.context;r.globalCompositeOperation="source-over";var i=!1;if(t.visible){if(t instanceof PIXI.Sprite){var n=t.texture.frame;n&&(r.globalAlpha=t.worldAlpha,i=!1,r.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),r.drawImage(t.texture.baseTexture.source,n.x,n.y,n.width,n.height,(t.anchor.x-t.texture.trim.x)*-n.width,(t.anchor.y-t.texture.trim.y)*-n.height,n.width,n.height))}else t instanceof PIXI.Strip?(r.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),this.renderStrip(t)):t instanceof PIXI.TilingSprite&&(r.setTransform(e[0],e[3],e[1],e[4],e[2],e[5]),this.renderTilingSprite(t));for(var o=0;t.children.length>o;o++)this.renderDisplayObject(t.children[o])}},PIXI.CanvasRenderer.prototype.renderStripFlat=function(t){var e=this.context,r=t.verticies;t.uvs;var i=r.length/2;this.count++,e.beginPath();for(var n=1;i-2>n;n++){var o=2*n,s=r[o],a=r[o+2],h=r[o+4],c=r[o+1],u=r[o+3],l=r[o+5];e.moveTo(s,c),e.lineTo(a,u),e.lineTo(h,l)}e.fillStyle="#FF0000",e.fill(),e.closePath()},PIXI.CanvasRenderer.prototype.renderTilingSprite=function(t){var e=this.context;t.__tilePattern||(t.__tilePattern=e.createPattern(t.texture.baseTexture.source,"repeat")),e.beginPath();var r=t.tilePosition,i=t.tileScale;e.scale(i.x,i.y),e.translate(r.x,r.y),e.fillStyle=t.__tilePattern,e.fillRect(-r.x,-r.y,t.width/i.x,t.height/i.y),e.scale(1/i.x,1/i.y),e.translate(-r.x,-r.y)},PIXI.CanvasRenderer.prototype.renderStrip=function(t){var e=this.context,r=t.verticies,i=t.uvs,n=r.length/2;this.count++;for(var o=1;n-2>o;o++){var s=2*o,a=r[s],h=r[s+2],c=r[s+4],u=r[s+1],l=r[s+3],p=r[s+5],d=i[s]*t.texture.width,f=i[s+2]*t.texture.width,I=i[s+4]*t.texture.width,v=i[s+1]*t.texture.height,g=i[s+3]*t.texture.height,y=i[s+5]*t.texture.height;e.save(),e.beginPath(),e.moveTo(a,u),e.lineTo(h,l),e.lineTo(c,p),e.closePath(),e.clip();var b=d*g+v*I+f*y-g*I-v*f-d*y,_=a*g+v*c+h*y-g*c-v*h-a*y,m=d*h+a*I+f*c-h*I-a*f-d*c,x=d*g*c+v*h*I+a*f*y-a*g*I-v*f*c-d*h*y,P=u*g+v*p+l*y-g*p-v*l-u*y,T=d*l+u*I+f*p-l*I-u*f-d*p,X=d*g*p+v*l*I+u*f*y-u*g*I-v*f*p-d*l*y;e.transform(_/b,P/b,m/b,T/b,x/b,X/b),e.drawImage(t.texture.baseTexture.source,0,0),e.restore()}},PIXI.Strip=function(t,e,r){PIXI.DisplayObjectContainer.call(this),this.texture=t,this.blendMode=PIXI.blendModes.NORMAL;try{this.uvs=new Float32Array([0,1,1,1,1,0,0,1]),this.verticies=new Float32Array([0,0,0,0,0,0,0,0,0]),this.colors=new Float32Array([1,1,1,1]),this.indices=new Uint16Array([0,1,2,3])}catch(i){this.uvs=[0,1,1,1,1,0,0,1],this.verticies=[0,0,0,0,0,0,0,0,0],this.colors=[1,1,1,1],this.indices=[0,1,2,3]}this.width=e,this.height=r,t.baseTexture.hasLoaded?(this.width=this.texture.frame.width,this.height=this.texture.frame.height,this.updateFrame=!0):(this.onTextureUpdateBind=this.onTextureUpdate.bind(this),this.texture.addEventListener("update",this.onTextureUpdateBind)),this.renderable=!0},PIXI.Strip.constructor=PIXI.Strip,PIXI.Strip.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.Strip.prototype.setTexture=function(t){this.texture=t,this.width=t.frame.width,this.height=t.frame.height,this.updateFrame=!0},PIXI.Strip.prototype.onTextureUpdate=function(){this.updateFrame=!0},PIXI.Rope=function(t,e){PIXI.Strip.call(this,t),this.points=e;try{this.verticies=new Float32Array(4*e.length),this.uvs=new Float32Array(4*e.length),this.colors=new Float32Array(2*e.length),this.indices=new Uint16Array(2*e.length)}catch(r){this.verticies=verticies,this.uvs=uvs,this.colors=colors,this.indices=indices}this.refresh()},PIXI.Rope.constructor=PIXI.Rope,PIXI.Rope.prototype=Object.create(PIXI.Strip.prototype),PIXI.Rope.prototype.refresh=function(){var t=this.points;if(!(1>t.length)){var e=this.uvs,r=this.indices,i=this.colors,n=t[0],o=t[0];this.count-=.2,e[0]=0,e[1]=1,e[2]=0,e[3]=1,i[0]=1,i[1]=1,r[0]=0,r[1]=1;for(var s=t.length,a=1;s>a;a++){var o=t[a],h=4*a,c=a/(s-1);a%2?(e[h]=c,e[h+1]=0,e[h+2]=c,e[h+3]=1):(e[h]=c,e[h+1]=0,e[h+2]=c,e[h+3]=1),h=2*a,i[h]=1,i[h+1]=1,h=2*a,r[h]=h,r[h+1]=h+1,n=o}}},PIXI.Rope.prototype.updateTransform=function(){var t=this.points;if(!(1>t.length)){var e,r=this.verticies,i=t[0],n={x:0,y:0},o=t[0];this.count-=.2,r[0]=o.x+n.x,r[1]=o.y+n.y,r[2]=o.x-n.x,r[3]=o.y-n.y;for(var s=t.length,a=1;s>a;a++){var o=t[a],h=4*a;e=t.length-1>a?t[a+1]:o,n.y=-(e.x-i.x),n.x=e.y-i.y;var c=10*(1-a/(s-1));c>1&&(c=1);var u=Math.sqrt(n.x*n.x+n.y*n.y),l=this.texture.height/2;n.x/=u,n.y/=u,n.x*=l,n.y*=l,r[h]=o.x+n.x,r[h+1]=o.y+n.y,r[h+2]=o.x-n.x,r[h+3]=o.y-n.y,i=o}PIXI.DisplayObjectContainer.prototype.updateTransform.call(this)}},PIXI.Rope.prototype.setTexture=function(t){this.texture=t,this.updateFrame=!0},PIXI.TilingSprite=function(t,e,r){PIXI.DisplayObjectContainer.call(this),this.texture=t,this.width=e,this.height=r,this.renderable=!0,this.tileScale=new PIXI.Point(2,1),this.tilePosition=new PIXI.Point(0,0),this.blendMode=PIXI.blendModes.NORMAL},PIXI.TilingSprite.constructor=PIXI.TilingSprite,PIXI.TilingSprite.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),PIXI.TilingSprite.prototype.setTexture=function(t){this.texture=t,this.updateFrame=!0},PIXI.TilingSprite.prototype.onTextureUpdate=function(){this.updateFrame=!0},PIXI.BaseTextureCache={},PIXI.texturesToUpdate=[],PIXI.BaseTexture=function(t){if(PIXI.EventTarget.call(this),this.width=100,this.height=100,this.source=t,this.source instanceof Image)if(this.source.complete)this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,PIXI.texturesToUpdate.push(this);else{var e=this;this.source.onload=function(){e.hasLoaded=!0,e.width=e.source.width,e.height=e.source.height,PIXI.texturesToUpdate.push(e),e.dispatchEvent({type:"loaded",content:e})}}else this.hasLoaded=!0,this.width=this.source.width,this.height=this.source.height,PIXI.texturesToUpdate.push(this);this._powerOf2=!1},PIXI.BaseTexture.constructor=PIXI.BaseTexture,PIXI.BaseTexture.fromImage=function(t,e){var r=PIXI.BaseTextureCache[t];if(!r){var i=new Image;e&&(i.crossOrigin=""),i.src=t,r=new PIXI.BaseTexture(i),PIXI.BaseTextureCache[t]=r}return r},PIXI.TextureCache={},PIXI.FrameCache={},PIXI.Texture=function(t,e){if(PIXI.EventTarget.call(this),e||(this.noFrame=!0,e=new PIXI.Rectangle(0,0,1,1)),this.trim=new PIXI.Point,t instanceof PIXI.Texture&&(t=t.baseTexture),this.baseTexture=t,this.frame=e,this.scope=this,t.hasLoaded)this.noFrame&&(e=new PIXI.Rectangle(0,0,t.width,t.height)),this.setFrame(e);else{var r=this;t.addEventListener("loaded",function(){r.onBaseTextureLoaded()})}},PIXI.Texture.constructor=PIXI.Texture,PIXI.Texture.prototype.onBaseTextureLoaded=function(){var t=this.baseTexture;t.removeEventListener("loaded",this.onLoaded),this.noFrame&&(this.frame=new PIXI.Rectangle(0,0,t.width,t.height)),this.noFrame=!1,this.width=this.frame.width,this.height=this.frame.height,this.scope.dispatchEvent({type:"update",content:this})},PIXI.Texture.prototype.setFrame=function(t){if(this.frame=t,this.width=t.width,this.height=t.height,t.x+t.width>this.baseTexture.width||t.y+t.height>this.baseTexture.height)throw Error("Texture Error: frame does not fit inside the base Texture dimensions "+this);this.updateFrame=!0,PIXI.Texture.frameUpdates.push(this)},PIXI.Texture.fromImage=function(t,e){var r=PIXI.TextureCache[t];return r||(r=new PIXI.Texture(PIXI.BaseTexture.fromImage(t,e)),PIXI.TextureCache[t]=r),r},PIXI.Texture.fromFrame=function(t){var e=PIXI.TextureCache[t];if(!e)throw Error("The frameId '"+t+"' does not exist in the texture cache "+this);return e},PIXI.Texture.fromCanvas=function(t){var e=new PIXI.BaseTexture(t);return new PIXI.Texture(e)},PIXI.Texture.addTextureToCache=function(t,e){PIXI.TextureCache[e]=t},PIXI.Texture.removeTextureFromCache=function(t){var e=PIXI.TextureCache[t];return PIXI.TextureCache[t]=null,e},PIXI.Texture.frameUpdates=[],PIXI.SpriteSheetLoader=function(t){PIXI.EventTarget.call(this),this.url=t,this.baseUrl=t.replace(/[^\/]*$/,""),this.texture,this.frames={},this.crossorigin=!1},PIXI.SpriteSheetLoader.constructor=PIXI.SpriteSheetLoader,PIXI.SpriteSheetLoader.prototype.load=function(){this.ajaxRequest=new AjaxRequest;var t=this;this.ajaxRequest.onreadystatechange=function(){t.onLoaded()},this.ajaxRequest.open("GET",this.url,!0),this.ajaxRequest.overrideMimeType&&this.ajaxRequest.overrideMimeType("application/json"),this.ajaxRequest.send(null)},PIXI.SpriteSheetLoader.prototype.onLoaded=function(){if(4==this.ajaxRequest.readyState&&(200==this.ajaxRequest.status||-1==window.location.href.indexOf("http"))){var jsondata=eval("("+this.ajaxRequest.responseText+")"),textureUrl=this.baseUrl+jsondata.meta.image;this.texture=PIXI.Texture.fromImage(textureUrl,this.crossorigin).baseTexture;var frameData=jsondata.frames;for(var i in frameData){var rect=frameData[i].frame;rect&&(PIXI.TextureCache[i]=new PIXI.Texture(this.texture,{x:rect.x,y:rect.y,width:rect.w,height:rect.h}),frameData[i].trimmed&&(PIXI.TextureCache[i].realSize=frameData[i].spriteSourceSize,PIXI.TextureCache[i].trim.x=0))}if(this.texture.hasLoaded)this.dispatchEvent({type:"loaded",content:this});else{var scope=this;this.texture.addEventListener("loaded",function(){scope.dispatchEvent({type:"loaded",content:scope})})}}},PIXI.AssetLoader=function(t){PIXI.EventTarget.call(this),this.assetURLs=t,this.assets=[],this.crossorigin=!1},PIXI.AssetLoader.constructor=PIXI.AssetLoader,PIXI.AssetLoader.prototype.load=function(){this.loadCount=this.assetURLs.length;for(var t=["jpeg","jpg","png","gif"],e=["json"],r=0;this.assetURLs.length>r;r++){for(var i=this.assetURLs[r],n=i.split(".").pop().toLowerCase(),o=null,s=0;t.length>s;s++)if(n==t[s]){o="img";break}if("img"!=o)for(var s=0;e.length>s;s++)if(n==e[s]){o="atlas";break}if("img"==o){var a=PIXI.Texture.fromImage(i,this.crossorigin);if(a.baseTexture.hasLoaded)this.loadCount--,0==this.loadCount&&(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete());else{var h=this;a.baseTexture.addEventListener("loaded",function(){h.onAssetLoaded()}),this.assets.push(a)}}else{if("atlas"!=o)throw Error(i+" is an unsupported file type "+this);var c=new PIXI.SpriteSheetLoader(i);c.crossorigin=this.crossorigin,this.assets.push(c);var h=this;c.addEventListener("loaded",function(){h.onAssetLoaded()}),c.load()}}},PIXI.AssetLoader.prototype.onAssetLoaded=function(){this.loadCount--,this.dispatchEvent({type:"onProgress",content:this}),this.onProgress&&this.onProgress(),0==this.loadCount&&(this.dispatchEvent({type:"onComplete",content:this}),this.onComplete&&this.onComplete())}(function(){var t=this,e=e||{};e.Layers=function(){PIXI.DisplayObjectContainer.call(this),this.blockedNames=Object.keys(this);for(var t in arguments){var e=arguments[t];if("string"==typeof e)this.addLayer(e);else if(e instanceof Object)for(var r in e)this[r]=e[r],this.addChild(e[r])}},e.Layers.constructor=e.Layers,e.Layers.prototype=Object.create(PIXI.DisplayObjectContainer.prototype),e.Layers.prototype.addLayer=function(t){return this.addLayerAt(t,this.children.length)},e.Layers.prototype.addLayerAt=function(t,e){if(t in this)throw Error(t+" Suplied name already used by "+this[t]);var r=new PIXI.DisplayObjectContainer;return r.layername=t,this.addChildAt(r,e),this[t]=r,r},e.DisplayObjectContainer.prototype.swapLayers=function(t,e){var r=this[t],i=this[e];this.swapChildren(r,i)},e.DisplayObjectContainer.prototype.getLayer=function(t){return this[t]||this.addLayer(t),this[t]
},e.DisplayObjectContainer.prototype.getLayerAt=function(t){return this.getChildAt(t)},e.Layers.prototype.removeLayer=function(t){t in this&&!(t in this.blockedNames)&&(PIXI.DisplayObjectContainer.prototype.removeChild.call(this,this[t]),delete this[t])},e.Layers.prototype.removeChild=function(t){t.layername&&t.layername in this&&delete this[t.layername],PIXI.DisplayObjectContainer.prototype.removeChild.call(this,t)},e.MovieClipManager=function(){PIXI.DisplayObjectContainer.call(this),this._animations={},this._current=void 0;for(var t in arguments){var e=arguments[t];this.add(e.name,e.clip)}},e.MovieClipManager.constructor=e.MovieClipManager,e.MovieClipManager.prototype=Object.create(e.DisplayObjectContainer.prototype),e.MovieClipManager.prototype.get=function(t){return this._animations[t]},e.MovieClipManager.prototype.set=function(t){return this._current&&(this._current.stop(),this._current.visible=!1),this._current=this._animations[t],this._current&&(this._current.visible=!0),this},e.MovieClipManager.prototype.play=function(t){return t&&this.set(t),this._current&&this._current.play(),this},e.MovieClipManager.prototype.gotoAndStop=function(t){return this._current.gotoAndStop(t),this},e.MovieClipManager.prototype.gotoAndPlay=function(t){return this._current.gotoAndPlay(t),this},e.MovieClipManager.prototype.animationSpeed=function(t){return this._current.animationSpeed=t,this},e.MovieClipManager.prototype.loop=function(t){return this._current.loop=t,this},e.MovieClipManager.prototype.onComplete=function(t){return this._current.onComplete=t,this},e.MovieClipManager.prototype.stop=function(){return this._current&&this._current.stop(),this},e.MovieClipManager.prototype.add=function(t,e,r){return this._animations[t]=e,e.animationSpeed=r||e.animationSpeed,this.addChild(e),e.visible=!1,this},e.MovieClipManager.prototype.remove=function(t){this._animations[t]===this._current&&(this._current.visible=!1,this._current=void 0),delete this._animations[t]},"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=e),exports.LINK=e):t.LINK=e}).call(this);